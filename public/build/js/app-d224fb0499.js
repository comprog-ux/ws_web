var app=angular.module("app",["angular-jwt","angular.filter","ngAnimate","ui.router","ui.calendar","ui.bootstrap","ui.bootstrap.datetimepicker","ui.sortable","ngFileSaver","app.auth","app.admin","app.admin.clubs","app.admin.districts","app.admin.invoices","app.admin.signups","app.admin.users","app.calendar","app.championships","app.championships.signups","app.clubs","app.clubs.championships","app.clubs.competitions","app.clubs.invoices","app.districts","app.districts.invoices","app.competitions","app.competitions.create","app.competitions.results","app.competitions.patrols","app.competitions.signups","app.competitions.teams","app.competitions.admin","app.competitions.admin.admins","app.competitions.admin.export","app.competitions.admin.weaponclasses","app.competitions.admin.patrols","app.competitions.admin.results","app.competitions.admin.results.prices","app.competitions.admin.stations","app.competitions.admin.signups","app.competitions.admin.teams","app.competitions.admin.invoices","app.competitions.admin.users","app.dashboard","app.errorhandler","app.invoices","app.premium","app.settings","app.signups","app.teams","app.users","app.public.competitions"],["$interpolateProvider",function(t){t.startSymbol("<%"),t.endSymbol("%>")}]);app.run(["$rootScope","$state","$timeout","ErrorHandlerFactory","jwtHelper","AuthFactory","$window","$location",function(t,e,a,n,i,o,s,r){s.ga("create","UA-76221618-1","auto"),t.$on("$stateChangeStart",function(a,n){var s=localStorage.getItem("token");if(t.currentRoute=n.name,null!==s)try{var r=JSON.parse(localStorage.getItem("user"));t.currentUser=r,t.authenticated=!0,Raven.setUserContext({id:r.user_id,email:r.email,username:r.fullname})}catch(l){localStorage.removeItem("user"),localStorage.removeItem("token"),t.authenticated=!1,t.currentUser=null,e.go("auth.login",{},{location:"replace"})}"auth"===n.name.split(".",1)[0]&&t.authenticated&&e.go("dashboard",{},{location:"replace"}),n.restricted&&(null===s&&(a.preventDefault(),e.go("auth.login",{},{location:"replace"})),null!==s&&i.isTokenExpired(s)&&o.attemptRefreshToken(),t.datepickerOptions={showWeeks:!0,startingDay:1},t.timepickerOptions={showMeridian:!1,minuteStep:15}),t.loadingState=""}),t.$on("$stateChangeSuccess",function(t){s.ga("send","pageview",r.path())}),t.catchError=function(e){t.errorMessages=[],t.successMessages=[],"string"==typeof e?t.errorMessages.push(e):e&&(angular.forEach(e,function(e){var a="string"==typeof e?e:e[0];t.errorMessages.push(a)}),a(function(){t.errorMessages=[]},5e3))},t.displayFlashMessages=function(e,n){a.cancel(t.errorMessageTimer),t.errorMessages=[],t.successMessages=[],angular.isString(e)&&(e=[e]);var i=["token_not_provided"];angular.forEach(e,function(e){if(i.indexOf(e)<0){var a="string"==typeof e?e:e[0];"error"==n?t.errorMessages.push(a):t.successMessages.push(a)}}),t.errorMessageTimer=a(function(){t.errorMessages=[],t.successMessages=[]},5e3)},t.reportError=function(e,a){a||(a="Frontend"),e&&n.reportError(e,a).then(function(e){e.message?e.message&&t.displayFlashMessages([e.message],"warning"):e.data&&e.data.message&&t.displayFlashMessages([e.data.message],"warning")})}}]),angular.module("app.admin.clubs",[]).controller("AdminClubsController",["$rootScope","$stateParams","$state","AdminClubsFactory",function(t,e,a,n){var i=this;i.load=function(){t.loadingState=!0;var a={current_page:e.current_page,hide_without_admins:e.hide_without_admins,hide_without_users:e.hide_without_users,hide_deleted:e.hide_deleted,per_page:e.per_page,search:e.search};n.load(a).then(function(e){i.clubs=e.data.clubs,t.loadingState=!1})},i.updatePage=function(){var t={search:i.clubs.search,current_page:i.clubs.current_page,hide_without_admins:i.clubs.hide_without_admins,hide_without_users:i.clubs.hide_without_users,hide_deleted:i.clubs.hide_deleted,per_page:i.clubs.per_page};a.go("admin.clubs.index",t,{location:"replace"})},i.load()}]).controller("AdminClubController",["$rootScope","$scope","$stateParams","$state","$timeout","AdminClubsFactory",function(t,e,a,n,i,o){function s(){t.loadingState=!0,o.find(a.id).then(function(e){r.club=e.data.club,r.districts=e.data.districts,t.loadingState=!1},function(){n.go("admin.clubs",{},{location:"replace"}),t.loadingState=!1})}var r=this;r.searchQuery="",r.selectedclub={},a.id||n.go("admin.clubs"),r.updateClub=function(){o.updateClub(r.club).then(function(e){t.displayFlashMessages(e.data.message),r.club=e.data.club,r.districts=e.data.districts,n.go("admin.clubs.show",{id:r.club.id},{location:"replace"})},function(e){t.displayFlashMessages(e.data.message,"error")})},r.deleteClub=function(t){o.deleteClub(t).then(function(){n.go("clubs")})},r.searchForClubs=function(e,a){return o.searchForClubs(e).then(function(t){return r.foundMatch=t.data.clubs.length>0,t.data.clubs.map(function(t){return t.alreadySelected=!1,a.id==t.id&&(t.alreadySelected=!0),t})},function(e){t.displayFlashMessages(e.data,"warning")})},r.selectClub=function(t){r.selectedclub=t},r.mergeClubs=function(e,a){e&&a&&o.mergeClubs(e,a).then(function(e){t.displayFlashMessages(e.data.message),n.go("admin.clubs.show",{id:a},{location:"replace"})})},s()}]).factory("AdminClubsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"admin/clubs";return current_page=a.current_page?a.current_page:1,n+="?page="+current_page,a.search&&(n+="&search="+a.search),a.per_page&&(n+="&per_page="+a.per_page),a.hide_without_admins&&(n+="&hide_without_admins="+a.hide_without_admins),a.hide_without_users&&(n+="&hide_without_users="+a.hide_without_users),a.hide_deleted&&(n+="&hide_deleted="+a.hide_deleted),t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"admin/clubs/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createClub:function(a){return t({method:"POST",url:e+"admin/clubs",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})},updateClub:function(a){return t({method:"PUT",url:e+"admin/clubs/"+a.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})},deleteClub:function(a){return t({method:"DELETE",url:e+"admin/clubs/"+a.id,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},loadUserClub:function(){return t({method:"GET",url:e+"admin/clubs/getUserClub",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},addUserToClubs:function(a){return t({method:"POST",url:e+"admin/clubs/addUserToClubs",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({clubs_id:a})})},addNewClub:function(a){return t({method:"POST",url:e+"admin/clubs/addNewClub",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({clubs_nr:a.clubs_nr,name:a.name})})},searchForClubs:function(a){return t({method:"POST",url:e+"admin/clubs/search",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({searchQuery:a})})},addUserAsAdmin:function(a){return t({method:"POST",url:e+"admin/clubs/addUserAsAdmin",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({admin:a})})},deleteUserAsAdmin:function(a){return t({method:"DELETE",url:e+"admin/clubs/deleteUserAsAdmin",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({admin:a})})},mergeClubs:function(a,n){return t({method:"POST",url:e+"admin/clubs/merge",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({clubsIdFrom:a,clubsIdTo:n})})}}}]),angular.module("app.admin.districts",[]).controller("AdminDistrictsController",["$rootScope","$stateParams","$state","AdminDistrictsFactory",function(t,e,a,n){var i=this;i.load=function(){t.loadingState=!0;var a={current_page:e.current_page,per_page:e.per_page,search:e.search};n.load(a).then(function(e){i.districts=e.data.districts,t.loadingState=!1})},i.updatePage=function(){var t={search:i.districts.search,current_page:i.districts.current_page,per_page:i.districts.per_page};a.go("admin.districts.index",t,{location:"replace"})},i.load()}]).controller("AdminDistrictController",["$rootScope","$scope","$stateParams","$state","$timeout","AdminDistrictsFactory",function(t,e,a,n,i,o){function s(){t.loadingState=!0,o.find(a.id).then(function(e){r.district=e.data.district,t.loadingState=!1},function(){n.go("admin.districts",{},{location:"replace"}),t.loadingState=!1})}var r=this;r.searchQuery="",r.selecteddistrict={},a.id||n.go("admin.districts"),r.updateDistrict=function(e){r.state="updating",o.updateDistrict(e).then(function(a){t.displayFlashMessages(a.data.message),r.districts.districts=a.data.districts,r.state="updated",n.go("district",{id:e.id})},function(e){t.displayFlashMessages(e.data.message,"error")})},r.deleteDistrict=function(t){o.deleteDistrict(t).then(function(){n.go("districts")})},r.searchForDistricts=function(e,a){return o.searchForDistricts(e).then(function(t){return r.foundMatch=t.data.districts.length>0,t.data.districts.map(function(t){return t.alreadySelected=!1,a.id==t.id&&(t.alreadySelected=!0),t})},function(e){t.displayFlashMessages(e.data,"warning")})},r.selectDistrict=function(t){r.selecteddistrict=t},r.mergeDistricts=function(e,a){e&&a&&o.mergeDistricts(e,a).then(function(e){t.displayFlashMessages(e.data.message),n.go("admin.districts.show",{id:a},{location:"replace"})})},s()}]).factory("AdminDistrictsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"admin/districts";return current_page=a.current_page?a.current_page:1,n+="?page="+current_page,a.search&&(n+="&search="+a.search),a.per_page&&(n+="&per_page="+a.per_page),t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"admin/districts/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createDistrict:function(a){return t({method:"POST",url:e+"admin/districts",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})},updateDistrict:function(a){return t({method:"PUT",url:e+"admin/districts/"+a.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})},deleteDistrict:function(a){return t({method:"DELETE",url:e+"admin/districts/"+a.id,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},addNewDistrict:function(a){return t({method:"POST",url:e+"admin/districts/addNewDistrict",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({districts_nr:a.districts_nr,name:a.name})})},searchForDistricts:function(a){return t({method:"POST",url:e+"districts/search",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({searchQuery:a})})}}}]),angular.module("app.admin.invoices",[]).controller("AdminInvoicesController",["$rootScope","$stateParams","$state","AdminInvoicesFactory","FileSaver","Blob",function(t,e,a,n,i,o){var s=this;s.load=function(){t.loadingState=!0;var a={current_page:e.current_page,per_page:e.per_page,search:e.search,payment_status:e.payment_status};n.load(a).then(function(e){s.invoices=e.data.invoices,s.invoices_overview=e.data.invoices_overview,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},s.updatePage=function(){var t={search:s.invoices.search,payment_status:s.invoices.payment_status,current_page:s.invoices.current_page,per_page:s.invoices.per_page};a.go("admin.invoices.index",t,{location:"replace"})},s.load(),s.download=function(t){n.download(t.id).then(function(e){var a=new o([e.data],{type:"application/pdf"});a.size&&i.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})}}]).controller("AdminInvoiceController",["$rootScope","$stateParams","$state","AdminInvoicesFactory","FileSaver","Blob",function(t,e,a,n,i,o){function s(){t.loadingState=!0,n.find(e.id).then(function(e){e.data.invoice||a.go("admin.invoices.index"),r.invoice=e.data.invoice,r.hideSignups=!0,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}var r=this;r.download=function(t){n.download(t.id).then(function(e){var a=new o([e.data],{type:"application/pdf"});a.size&&i.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})},s()}]).factory("AdminInvoicesFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"admin/invoices";return current_page=a.current_page?a.current_page:1,n+="?page="+current_page,a.search&&(n+="&search="+a.search),a.per_page&&(n+="&per_page="+a.per_page),a.payment_status&&(n+="&payment_status="+a.payment_status),t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"admin/invoices/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},download:function(a){if(a)return t({method:"GET",url:e+"admin/invoices/"+a+"/download",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.admin",[]).controller("AdminDashboardController",["$rootScope","$scope","$timeout","AdminFactory",function(t,e,a,n){function i(){t.loadingState=!0,n.loadDashboard().then(function(e){o.data=e.data,t.loadingState=!1})}var o=this;i()}]).factory("AdminFactory",["$http","ApiEndpointUrl",function(t,e){return{loadDashboard:function(){return t({method:"GET",url:e+"admin/dashboard",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.admin.signups",[]).controller("AdminSignupsController",["$rootScope","$stateParams","$state","AdminSignupsFactory","$timeout",function(t,e,a,n,i){var o=this;o.exporting=!1,o.load=function(){t.loadingState=!0;var a={current_page:e.current_page,per_page:e.per_page,competitions_id:e.competitions_id,search:e.search};n.load(a).then(function(e){o.signups=e.data.signups,o.competitions=e.data.competitions,t.loadingState=!1})},o.updatePage=function(){var t={search:o.signups.search,current_page:o.signups.current_page,per_page:o.signups.per_page,competitions_id:o.signups.competitions_id};a.go("admin.signups.index",t,{location:"replace"})},o.load()}]).controller("AdminSignupController",["$rootScope","$stateParams","$state","AdminSignupsFactory","AdminClubsFactory",function(t,e,a,n,i){function o(){t.loadingState=!0,e.signup_id?n.find(e.signup_id).then(function(e){s.weaponclasses=e.data.weaponclasses,s.signup=e.data.signup,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),s.signup="",t.loadingState=!1}):(s.signup={},t.loadingState=!1)}var s=this;s.searchQuery="",o(),s.saveSignup=function(e){var i={id:e.id,weaponclasses_id:e.weaponclasses_id,clubs_id:e.clubs_id};t.loadingState=!0,n.saveSignup(i).then(function(n){s.signup=n.data.signup,t.displayFlashMessages(n.data.message),a.go("admin.signups.show",{signup_id:e.id},{location:"reload"}),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},s.searchForClubs=function(e){return i.searchForClubs(e).then(function(t){return t.data.clubs.map(function(t){return t.alreadySelected=!1,s.signup.clubs_id===t.id&&(t.alreadySelected=!0),t})},function(e){t.displayFlashMessages(e.data,"warning")})},s.selectClub=function(t){s.signup.club=t,s.signup.clubs_id=t.id},s.removeClubAssociation=function(){s.signup.club=null,s.signup.clubs_id=null}}]).factory("AdminSignupsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"admin/signups";return current_page=a.current_page?a.current_page:1,n+="?page="+current_page,a.search&&(n+="&search="+a.search),a.per_page&&(n+="&per_page="+a.per_page),a.competitions_id&&(n+="&competitions_id="+a.competitions_id),a.specialwishes&&(n+="&status="+a.specialwishes),t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},saveSignup:function(a){return t({method:"PUT",url:e+"admin/signups/"+a.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})},find:function(a){return t({method:"GET",url:e+"admin/signups/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},"export":function(){return t({method:"POST",url:e+"admin/signups/export",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.admin.users",[]).controller("AdminUsersController",["$rootScope","$stateParams","$state","AdminUsersFactory","$timeout",function(t,e,a,n,i){var o=this;o.load=function(){t.loadingState=!0;var a={current_page:e.current_page,per_page:e.per_page,search:e.search,status:e.status};n.load(a).then(function(e){o.users=e.data.users,t.loadingState=!1})},o.updatePage=function(){var t={search:o.users.search,status:o.users.status,current_page:o.users.current_page,per_page:o.users.per_page};a.go("admin.users.index",t,{location:"replace"})},o.load()}]).controller("AdminUserController",["$rootScope","$stateParams","$state","AdminUsersFactory","AdminClubsFactory","AdminInvoicesFactory","FileSaver","Blob",function(t,e,a,n,i,o,s,r){function l(){t.loadingState=!0,e.user_id?n.find(e.user_id).then(function(e){c.user=e.data,c.user.club_ids=[],angular.forEach(c.user.clubs,function(t){c.user.club_ids.push(t.id)}),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),c.user="",t.loadingState=!1}):(c.user={},t.loadingState=!1)}var c=this;c.searchQuery="",l(),c.saveUser=function(e){t.loadingState=!0,n.saveUser(e).then(function(n){t.displayFlashMessages(n.data),a.go("admin.users.show",{user_id:e.user_id},{location:"reload"}),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},c.createUser=function(e){return!c.loadingState&&(c.loadingState=!0,void n.createUser(e).then(function(e){t.displayFlashMessages(e.data),a.go("admin.users.show",{user_id:e.data.user_id},{location:"reload"}),c.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),c.loadingState=!1}))},c.downloadInvoice=function(t){o.download(t.id).then(function(e){var a=new r([e.data],{type:"application/pdf"});a.size&&s.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})},c.searchForClubs=function(e){return i.searchForClubs(e).then(function(t){return t.data.clubs.map(function(t){return t.alreadySelected=!1,c.user.clubs.length>0&&c.user.clubs[0].id==t.id&&(t.alreadySelected=!0),t})},function(e){t.displayFlashMessages(e.data,"warning")})},c.selectClub=function(t){c.user.clubs=[t],c.user.club_ids=[t.id]},c.removeClubAssociation=function(t){c.user.clubs=[],c.user.club_ids=[]}}]).controller("AdminUserImportController",["$rootScope","$stateParams","$state","AdminUsersFactory","$timeout",function(t,e,a,n,i){var o=this;o.importing=!1,o["import"]=function(){var e=document.getElementById("import-file").files;if(0===e.length)return!1;o.importing=!0;var a=new FormData;a.append("file",e[0]),n.importUsers(a).then(function(e){t.displayFlashMessages(e.data,"success"),o.importing=!1},function(e){t.displayFlashMessages(e.data,"error"),o.importing=!1})}}]).controller("AdminUserClubChangesController",["$rootScope","$scope","$stateParams","$state","AdminUsersFactory",function(t,e,a,n,i){var o=this;o.loadClubChanges=function(){t.loadingState=!0,i.loadClubChanges().then(function(e){o.clubChanges=e.data,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},o.approveClubChange=function(e){t.loadingState=!0,i.approveClubChange(e).then(function(e){t.displayFlashMessages(e.data,"message"),t.loadingState=!1,o.loadClubChanges()},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},o.cancelClubChange=function(e){t.loadingState=!0,i.cancelClubChange(e).then(function(e){t.displayFlashMessages(e.data,"message"),t.loadingState=!1,o.loadClubChanges()},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},o.loadClubChanges()}]).factory("AdminUsersFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"admin/users";return current_page=a.current_page?a.current_page:1,n+="?page="+current_page,a.search&&(n+="&search="+a.search),a.per_page&&(n+="&per_page="+a.per_page),a.status&&(n+="&status="+a.status),t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"admin/users/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},saveUser:function(a){var n=angular.copy(a);return n.birthday=n.birthday+"-01-01",delete n.clubs,delete n.signups,delete n.clubs,delete n.invoices_incoming,t({method:"PUT",url:e+"admin/users/"+n.user_id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},importUsers:function(a){return t({method:"POST",url:e+"admin/users/import",headers:{"Content-Type":void 0},data:a})},loadClubChanges:function(){return t({method:"GET",url:e+"admin/clubChanges",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},approveClubChange:function(a){return t({method:"PUT",url:e+"admin/clubChanges/"+a.id+"/approve",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},cancelClubChange:function(a){return t({method:"PUT",url:e+"admin/clubChanges/"+a.id+"/cancel",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.auth",["vcRecaptcha"]).controller("AuthController",["$rootScope","$scope","$state","$stateParams","AuthFactory","$uibModal","$timeout","$templateCache",function(t,e,a,n,i,o,s,r){e.auth={email:"",name:"",lastname:"",password:"",invite_token:n.invite_token},e.login=function(){e.loggingIn=!0;var n={email:e.auth.email,password:e.auth.password};i.authenticate(n).then(function(n){r.removeAll(),localStorage.setItem("token",n.data.access_token),i.getUser().then(function(e){s(function(){localStorage.setItem("user",JSON.stringify(e.data.user)),t.currentUser=e.data.user,t.authenticated=!0,a.go("dashboard",{},{location:"replace"})},1e3)},function(n){localStorage.removeItem("user"),localStorage.removeItem("token"),t.authenticated=!1,t.currentUser=null,e.loggingIn=!1,"user_not_active"==n.data&&s(function(){a.go("auth.inactive",{},{location:"replace"})},50)})},function(a){t.displayFlashMessages(a.data.message,"error"),e.loggingIn=!1,t.loadingState="",t.currentUser=!1,t.authenticated=!1})},e.register=function(){e.auth.recaptcharesponse&&(e.registerState="registrering",i.register(e.auth).then(function(){e.registerState="done",e.auth={}},function(a){t.displayFlashMessages(a.data,"error"),t.loadingState="",e.registerState=!1}))},e.reset={email:""},e.requestPasswordReset=function(){e.reset.email&&i.requestPasswordReset({email:e.reset.email}).then(function(t){e.reset.email="",e.passwordRequested=!0},function(a){t.displayFlashMessages(a.data,"error"),e.passwordRequested=!1})},e.termsModalOpen=function(){self.termsModal=o.open({animation:e.animationsEnabled,templateUrl:"/publicviews/terms",size:"md",controller:["$uibModalInstance",function(t){this.close=function(){t.dismiss("cancel")}}],controllerAs:"modal"})}}]).controller("ActivationController",["$state","$rootScope","$scope","$http","$stateParams","AuthFactory","$timeout",function(t,e,a,n,i,o,s){localStorage.removeItem("user"),localStorage.removeItem("token"),e.authenticated=!1,e.currentUser=null,a.activate={token:i.token},a.no_password=!1,a.verifyToken=function(){o.activate(a.activate).then(function(){a.activated=!0},function(t){"invalid_code"==t.data.error?e.displayFlashMessages(t.data.message,"error"):"no_password"==t.data.error&&(a.no_password=!0,e.displayFlashMessages(t.data.message,"warning")),a.activated=!1})}}]).factory("AuthFactory",["$http","$filter","$timeout","$state","$rootScope","ApiEndpointUrl","oauthClientSecret",function(t,e,a,n,i,o,s){return{authenticate:function(e){return e.client_secret=s,e.grant_type="password",e.username=e.email,e.client_id=1,t({method:"POST",url:o+"oauth/token",data:e})},getUser:function(){return t({method:"GET",url:o+"authenticate/user"})},logout:function(){localStorage.removeItem("user"),localStorage.removeItem("token"),i.authenticated=!1,i.currentUser=null,n.go("auth.login",{},{location:"replace"})},requestPasswordReset:function(e){return t({method:"POST",url:o+"password/email",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)})},resetPassword:function(e){return t({method:"POST",url:o+"password/reset",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)})},register:function(e){return t({method:"POST",url:o+"register",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)})},activate:function(e){return t({method:"POST",url:o+"activate",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(e)})},attemptRefreshToken:function(e){return t({method:"POST",url:o+"refresh"}).then(function(a){return a.data.access_token?(localStorage.setItem("token",a.data.access_token),e?(e.headers={Authorization:"Bearer "+localStorage.getItem("token")},t(e)):void location.reload(!0)):(e=void 0,localStorage.removeItem("user"),localStorage.removeItem("token"),i.authenticated=!1,i.currentUser=null,n.go("auth.login"),!1)},function(){return e=void 0,localStorage.removeItem("user"),localStorage.removeItem("token"),i.authenticated=!1,i.currentUser=null,n.go("auth.login"),!1})}}}]),angular.module("app.calendar",[]).controller("CalendarController",["$scope","$http","$timeout","ApiEndpointUrl",function(t,e,a,n){function i(){$apiUrl=n+"calendar",t.calendarEvents=[{url:n+"calendar"}],t.uiConfig={calendar:{lang:"sv",buttonText:{today:"idag",month:"månad",week:"vecka",day:"dag"},firstDay:"1",weekNumbers:!0,header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},columnFormat:{day:"ddd DD/MM",week:"ddd DD/MM",month:"ddd"},titleFormat:{month:"MMMM YYYY",week:"MMMM D YYYY",day:"MMMM D YYYY"},weekNumberTitle:"",axisFormat:"H:mm",timeFormat:"H:mm",minTime:"6:00",maxTime:"23:59",allDaySlot:!1,defaultView:"month",height:500,editable:!1,viewRender:function(e,a){var i=Date.parse(e.start._d),o=Date.parse(e.end._d);t.calendarEvents=[{url:n+"calendar?start="+i+"&end="+o}]},eventClick:t.alertOnEventClick,eventDrop:t.alertOnDrop,eventResize:function(t,e){}}},t.changeView=function(t,e){e.fullCalendar("changeView",t)},t.renderCalender=function(t){a(function(){t&&t.fullCalendar("render")},0)}}i()}]),angular.module("app.championships.signups",[]).controller("ChampionshipSignupsController",["$rootScope","$stateParams","$state","ChampionshipSignupsFactory","$timeout",function(t,e,a,n,i){var o=this;o.load=function(){t.loadingState=!0;var a={championships_id:e.championships_id,current_page:e.current_page,per_page:e.per_page,competitions_id:e.competitions_id,search:e.search};n.load(a).then(function(e){o.signups=e.data.signups,o.competitions=e.data.competitions,t.loadingState=!1})},o.updatePage=function(){var t={championships_id:e.championships_id,search:o.signups.search,current_page:o.signups.current_page,per_page:o.signups.per_page,competitions_id:o.signups.competitions_id};a.go("championships.show.signups",t,{location:"replace"})},o.load()}]).factory("ChampionshipSignupsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"championships/"+a.championships_id+"/signups";return current_page=a.current_page?a.current_page:1,n+="?page="+current_page,a.search&&(n+="&search="+a.search),a.per_page&&(n+="&per_page="+a.per_page),a.competitions_id&&(n+="&competitions_id="+a.competitions_id),a.specialwishes&&(n+="&status="+a.specialwishes),t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.championships",[]).controller("ChampionshipsController",["$rootScope","$scope","$stateParams","$state","ChampionshipsFactory",function(t,e,a,n,i){var o=this;o.load=function(){t.loadingState=!0;var e={current_page:a.current_page,per_page:a.per_page,search:a.search,clubs_id:a.clubs_id,usersignup:a.usersignup};i.load(e).then(function(e){o.championships=e.data.championships,t.loadingState=!1})},o.updatePage=function(){var t={search:o.championships.search,current_page:o.championships.current_page,per_page:o.championships.per_page};n.go("championships.index",t,{location:"replace"})},o.load()}]).controller("ChampionshipController",["$rootScope","$scope","$stateParams","$state","ChampionshipsFactory",function(t,e,a,n,i){function o(){i.find(a.championships_id).then(function(t){s.championship=t.data.championship},function(){n.go("championships.index",{},{location:"replace"})})}var s=this;o()}]).factory("ChampionshipsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){var i=e+"championships";return current_page=a.current_page?a.current_page:1,i+="?page="+current_page,a.search&&(i+="&search="+a.search),a.per_page&&(i+="&per_page="+a.per_page),a.clubs_id&&(i+="&clubs_id="+a.clubs_id),t({method:"GET",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"championships/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.clubs.championships",[]).controller("ClubChampionshipsController",["$rootScope","$scope","$stateParams","$state","ChampionshipsFactory",function(t,e,a,n,i){var o=this;o.load=function(){t.loadingState=!0;var e={current_page:a.current_page,per_page:a.per_page,search:a.search,clubs_id:a.clubs_id};i.load(e).then(function(e){o.championships=e.data.championships,t.loadingState=!1})},o.updatePage=function(){var t={search:o.championships.search,current_page:o.championships.current_page,per_page:o.championships.per_page,clubs_id:o.championship.clubs_id};n.go("club.championships",t,{location:"replace"})},o.load()}]),angular.module("app.clubs.competitions",[]).controller("ClubCompetitionsController",["$rootScope","$scope","$stateParams","$state","CompetitionsFactory",function(t,e,a,n,i){var o=this;o.load=function(){t.loadingState=!0;var e={current_page:a.current_page,per_page:a.per_page,search:a.search,status:a.status,type:a.type,usersignup:a.usersignup,clubs_id:a.clubs_id};i.load(e).then(function(e){o.competitions=e.data.competitions,t.loadingState=!1})},o.updatePage=function(){var t={search:o.competitions.search,status:o.competitions.status,type:o.competitions.type,usersignup:o.competitions.usersignup,current_page:o.competitions.current_page,per_page:o.competitions.per_page,clubs_id:o.competitions.clubs_id};n.go("club.competitions",t,{location:"replace"})},o.load()}]),angular.module("app.clubs.invoices",[]).controller("ClubGenerateInvoicesController",["$rootScope","$stateParams","$state","ClubInvoicesFactory",function(t,e,a,n){function i(){t.loadingState=!0,n.loadPendingSignups().then(function(e){o.clubs=e.data.clubs,angular.forEach(o.clubs,function(t){angular.forEach(t.signups,function(t){o.selectedSignups.push(t.id)}),angular.forEach(t.teams,function(t){o.selectedTeams.push(t.id)})}),console.log(o.selectedTeams),o.hideSignups=!0,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}var o=this;o.selectedSignups=[],o.selectedTeams=[],o.createInvoice=function(){t.loadingState=!0,n.createInvoices().then(function(e){t.displayFlashMessages(e.data.message,"success"),a.go("club.invoices.index"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},o.createInvoicesFromSelectedRows=function(){t.loadingState=!0,n.createInvoicesFromSelectedRows(o.selectedSignups,o.selectedTeams).then(function(e){t.displayFlashMessages(e.data.message,"success"),a.go("club.invoices.index"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},o.toggleInvoiceSignup=function(t){o.selectedSignups.indexOf(t.id)===-1?o.selectedSignups.push(t.id):o.selectedSignups.splice(o.selectedSignups.indexOf(t.id),1)},o.toggleInvoiceTeam=function(t){o.selectedTeams.indexOf(t.id)===-1?o.selectedTeams.push(t.id):o.selectedTeams.splice(o.selectedTeams.indexOf(t.id),1)},o.teamIsSelected=function(t){return o.selectedTeams.indexOf(t.id)>-1},i()}]).controller("ClubInvoicesController",["$rootScope","$stateParams","$state","ClubInvoicesFactory","$uibModal","FileSaver","Blob","$filter",function(t,e,a,n,i,o,s,r){var l=this;l.argsToUrl=function(t){var e="";return t.direction&&(e+="&direction="+t.direction),t.search&&(e+="&search="+t.search),
t.per_page&&(e+="&per_page="+t.per_page),t.payment_status&&(e+="&payment_status="+t.payment_status),t.paid_at_start&&(e+="&paid_at_start="+t.paid_at_start),t.paid_at_end&&(e+="&paid_at_end="+t.paid_at_end),t.created_at_start&&(e+="&created_at_start="+t.created_at_start),t.created_at_end&&(e+="&created_at_end="+t.created_at_end),e},l.loadInvoices=function(){t.loadingState=!0;var a={direction:e.direction,current_page:e.current_page,per_page:e.per_page,search:e.search,payment_status:e.payment_status,paid_at_start:e.paid_at_start,paid_at_end:e.paid_at_end,created_at_start:e.created_at_start,created_at_end:e.created_at_end},i=a.current_page?a.current_page:1,o="?page="+i+l.argsToUrl(a);n.load(o).then(function(a){l.invoices=a.data.invoices,l.invoices_generate=a.data.invoices_generate,l.hideSignups=!0,e.paid_at_start&&(l.invoices.paid_at_start=e.paid_at_start),e.paid_at_end&&(l.invoices.paid_at_end=e.paid_at_end),e.created_at_start&&(l.invoices.created_at_start=e.created_at_start),e.created_at_end&&(l.invoices.created_at_end=e.created_at_end),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},l.updatePage=function(){var t={direction:l.invoices.direction,search:l.invoices.search,payment_status:l.invoices.payment_status,current_page:l.invoices.current_page,per_page:l.invoices.per_page,paid_at_start:r("date")(l.invoices.paid_at_start,"yyyy-MM-dd"),paid_at_end:r("date")(l.invoices.paid_at_end,"yyyy-MM-dd"),created_at_start:r("date")(l.invoices.created_at_start,"yyyy-MM-dd"),created_at_end:r("date")(l.invoices.created_at_end,"yyyy-MM-dd")};"outgoing"==t.direction?a.go("club.invoices.outgoing",t,{location:"replace"}):"incoming"==t.direction?a.go("club.invoices.incoming",t,{location:"replace"}):a.go("club.invoices.index",t,{location:"replace"})},l.print=function(){t.loadingState=!0;var a={direction:e.direction,current_page:e.current_page,per_page:e.per_page,search:e.search,payment_status:e.payment_status,paid_at_start:e.paid_at_start,paid_at_end:e.paid_at_end,created_at_start:e.created_at_start,created_at_end:e.created_at_end},i="?"+l.argsToUrl(a);n.print(i).then(function(e){var a=new s([e.data],{type:"application/pdf"});a.size&&o.saveAs(a,"Fakturalista.pdf"),t.loadingState=!1})},l.openPaymentModal=function(t){var e=i.open({animation:!0,templateUrl:"ClubInvoicePaymentModal.html",controller:"ClubInvoicePaymentModalController as modalcontroller",size:"md",resolve:{invoice:function(){return t}}});e.result.then(function(){l.loadInvoices()})},l.download=function(t){n.download(t.id).then(function(e){var a=new s([e.data],{type:"application/pdf"});a.size&&o.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})},l.loadInvoices()}]).controller("ClubInvoiceController",["$rootScope","$stateParams","$state","ClubInvoicesFactory","FileSaver","Blob",function(t,e,a,n,i,o){function s(){t.loadingState=!0,n.show(e.id).then(function(e){e.data.invoice||a.go("club.invoices.index"),r.invoice=e.data.invoice,r.hideSignups=!0,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}var r=this;r.download=function(t){n.download(t.id).then(function(e){var a=new o([e.data],{type:"application/pdf"});a.size&&i.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})},s()}]).controller("ClubInvoicePaymentModalController",["$scope","$uibModalInstance","invoice","ClubInvoicesFactory",function(t,e,a,n){var i=this;i.options={showWeeks:!0,startingDay:1,maxDate:new Date},i.invoice=angular.copy(a),i.registerPayment=function(t){t.paid_at&&!i.loadingState&&(i.loadingState=!0,n.registerPayment(t.id,t.paid_at).then(function(t){e.close(t.data),i.loadingState=!1}))},i.cancel=function(){e.dismiss("cancel")}}]).factory("ClubInvoicesFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){return t({method:"GET",url:e+"clubinvoices"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},print:function(a){return t({method:"GET",url:e+"clubinvoices/print"+a,responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},show:function(a){var n=a?"/"+a:"";return t({method:"GET",url:e+"clubinvoices"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},loadPendingSignups:function(){return t({method:"GET",url:e+"clubinvoices/pendingsignups",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createInvoices:function(){return t({method:"POST",url:e+"clubinvoices",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createInvoicesFromSelectedRows:function(a,n){return t({method:"POST",url:e+"clubinvoices?signup_ids="+a.toString()+"&team_ids="+n.toString(),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"clubinvoices/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},registerPayment:function(a,n){return n=moment(new Date(n)).format("YYYY-MM-DD HH:mm:ss"),t({method:"PUT",url:e+"clubinvoices/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({paid_at:n})})},download:function(a){if(a)return t({method:"GET",url:e+"clubinvoices/"+a+"/download",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.clubs",[]).controller("ClubController",["$rootScope","$scope","$state","ClubsFactory",function(t,e,a,n){function i(){t.loadingState=!0,n.loadUserClub().then(function(e){o.selectedClubs="",e.data.club||a.go("club.connect",{},{location:"replace"}),o.club=e.data.club,o.districts=e.data.districts,t.loadingState=!1})}var o=this;o.filter={users:{search:""},invoices:{search:""}},o.add_admin=null,o.updateClub=function(){var e=o.club;e.admins&&delete e.admins,e.users&&delete e.users,e.district&&delete e.district,delete e.logo;var i=new FormData;for(var s in e)e.hasOwnProperty(s)&&i.append(s,e[s]);var r=document.getElementById("club-logo").files[0];r&&i.append("logo",r),n.updateClub(i).then(function(){a.go("club.information",{},{location:"replace"})},function(e){t.displayFlashMessages(e.data,"error")})},o.addUserAsAdmin=function(e){e&&n.addUserAsAdmin(e).then(function(){i()},function(e){t.displayFlashMessages(e.data.message)})},o.deleteUserAsAdmin=function(e){e&&n.deleteUserAsAdmin(e).then(function(){i()},function(e){t.displayFlashMessages(e.data.message)})},i()}]).controller("ClubChangeController",["$rootScope","$scope","$state","ClubsFactory",function(t,e,a,n){var i=this;i.searchQuery="",i.selectedclub={},i.new_club=null,i.add_clubs_nr="",i.currentClub=null,i.loadUserClub=function(){t.loadingState=!0,n.loadUserClub().then(function(e){i.selectedClubs="",i.currentClub=e.data.club,t.loadingState=!1})},i.loadUserClub(),i.searchForClubs=function(e,a){return n.searchForClubs(e).then(function(t){return i.foundMatch=t.data.clubs.length>0,t.data.clubs.map(function(t){return t.alreadySelected=!1,i.currentClub.id==t.id&&(t.alreadySelected=!0),t})},function(e){t.displayFlashMessages(e.data,"warning")})},i.selectClub=function(t){return t.alreadySelected!==!0&&(i.noMatchingClubs=null,void(i.new_club=t))},i.noClubsFound=function(){i.noMatchingClubs=!0,i.new_club=null},i.changeClub=function(e){t.loadingState=!0,n.changeClub(e.id).then(function(e){i.new_club=null,t.displayFlashMessages(e.data.message,"success"),t.loadingState=!1,a.go("club.information",{},{location:"replace"})})}}]).controller("ClubConnectController",["$rootScope","$scope","$state","ClubsFactory",function(t,e,a,n){function i(){t.loadingState=!0,n.loadUserClub().then(function(e){o.selectedClubs="",e.data.club&&a.go("club.information",{},{location:"replace"}),o.club=e.data.club,t.loadingState=!1})}var o=this;o.searchQuery="",o.selectedclub={},o.new_club=null,o.add_clubs_nr="",o.changeClub=!1,o.searchForClubs=function(e,a){return n.searchForClubs(e).then(function(t){return o.foundMatch=t.data.clubs.length>0,t.data.clubs.map(function(t){return t.alreadySelected=!1,t})},function(e){t.displayFlashMessages(e.data,"warning")})},o.selectClub=function(t){return t.alreadySelected!==!0&&(o.noMatchingClubs=null,void(o.new_club=t))},o.noClubsFound=function(){o.noMatchingClubs=!0,o.new_club=null},o.addUserToClubs=function(t){n.addUserToClubs(t.id).then(function(t){o.new_club=null,o.changeClub=!1,o.club=t.data,a.go("club.information",{},{location:"replace"})})},o.addNewClub=function(){if(!o.searchQuery||!o.add_clubs_nr)return!1;var t={name:o.searchQuery,clubs_nr:o.add_clubs_nr};n.addNewClub(t).then(function(t){o.searchQuery="",o.add_clubs_nr="",o.new_club=null,o.changeClub=!1,o.club=t.data,a.go("club.information",{},{location:"replace"})})},i()}]).factory("ClubsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){var i=e+"clubs";return!angular.isUndefined(n)&&n>0&&(i+="/"+n),a&&(i+="?page="+a),t({method:"GET",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},loadClubChanges:function(){return t({method:"GET",url:e+"clubs/clubChanges",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"clubs/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createClub:function(a){return t({method:"POST",url:e+"clubs",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})},updateClub:function(a){return a.append("_method","PUT"),t({method:"POST",url:e+"clubs",headers:{"Content-Type":void 0},data:a})},deleteClub:function(a){return t({method:"DELETE",url:e+"clubs/"+a.id,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},loadUserClub:function(){return t({method:"GET",url:e+"clubs/getUserClub",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},addUserToClubs:function(a){return t({method:"POST",url:e+"clubs/addUserToClubs",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({clubs_id:a})})},changeClub:function(a){return t({method:"POST",url:e+"clubs/clubChanges",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({to_clubs_id:a})})},addNewClub:function(a){return t({method:"POST",url:e+"clubs/addNewClub",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({clubs_nr:a.clubs_nr,name:a.name})})},searchForClubs:function(a){return t({method:"POST",url:e+"clubs/search",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({searchQuery:a})})},addUserAsAdmin:function(a){return t({method:"POST",url:e+"clubs/addUserAsAdmin",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({admin:a})})},deleteUserAsAdmin:function(a){return t({method:"DELETE",url:e+"clubs/deleteUserAsAdmin",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({admin:a})})},approveClubChange:function(a){return t({method:"PUT",url:e+"clubs/clubChanges/"+a.id+"/approve",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},cancelClubChange:function(a){return t({method:"PUT",url:e+"clubs/clubChanges/"+a.id+"/cancel",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.admin.admins",[]).controller("CompetitionsAdminAdminsController",["$rootScope","$scope","$stateParams","$state","$uibModal","CompetitionsAdminAdminsFactory",function(t,e,a,n,i,o){var s=this;s.getAdmins=function(){t.loadingState=!0,o.getAdmins(a.competitions_id).then(function(e){s.users=e.data.users,s.roles=e.data.roles,s.admins=e.data.admins,s.newAdmin={competitions_id:a.competitions_id,users_id:null,role:""},t.loadingState=!1},function(){n.go("competitions.admin",{competitions_id:a.competitions_id},{location:"replace"}),t.loadingState=!1})},s.getAdmins(),s.createAdmin=function(){s.loadingState=!0,this.newAdmin.users_id&&this.newAdmin.role&&o.createAdmin(a.competitions_id,this.newAdmin).then(function(t){s.admins=t.data.admins,s.loadingState=!1},function(){n.go("competitions.admin.admins",{competitions_id:a.competitions_id},{location:"replace"}),s.loadingState=!1})},s.deleteAdmin=function(t){s.loadingState=!0,o.deleteAdmin(a.competitions_id,t.id).then(function(t){s.admins=t.data.admins,s.loadingState=!1},function(){n.go("competitions.admin.admins",{competitions_id:a.competitions_id},{location:"replace"}),s.loadingState=!1})}}]).factory("CompetitionsAdminAdminsFactory",["$http","ApiEndpointUrl",function(t,e){return{getAdmins:function(a){return t({method:"GET",url:e+"competitions/"+a+"/admin/admins",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createAdmin:function(a,n){return data=angular.copy(n),t({method:"POST",url:e+"competitions/"+a+"/admin/admins",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(data)})},deleteAdmin:function(a,n){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/admins/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.admin.export",[]).controller("CompetitionsAdminExportController",["$rootScope","$scope","$stateParams","$state","CompetitionsAdminPatrolsFactory","CompetitionsAdminResultsFactory","CompetitionsAdminFactory","FileSaver","Blob",function(t,e,a,n,i,o,s,r,l){var c=this;c.filter={patrol:"",patrol_type:"patrols",patrols_output:{pagebreak:"",orderby:"patrols"},signups_output:{pagebreak:"",orderby:"name"},results_output:{pagebreak:"",std_medals:"",prices:"",format:"pdf"}},e.$parent.find(),c.downloadPatrolsList=function(e){t.loadingState=!0,i.downloadPatrolsList(e.id,c.filter.patrols_output).then(function(a){var n=new l([a.data],{type:"application/pdf"});n.size&&r.saveAs(n,e.date+" "+e.name+" "+e.translations.patrols_list_singular+".pdf"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},c.downloadSignupsList=function(e){t.loadingState=!0,i.downloadSignupsList(e.id,c.filter.signups_output).then(function(a){var n=new l([a.data],{type:"application/pdf"});n.size&&r.saveAs(n,e.date+" "+e.name+" "+e.translations.signups+".pdf"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},c.downloadSignupsListAsXlsx=function(e){t.loadingState=!0,i.downloadSignupsListAsXlsx(e.id).then(function(e){window.location.href="/files/download?path="+e.data.filepath,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},c.downloadResultsList=function(e){t.loadingState=!0,o.downloadResultsList(e.id,c.filter.results_output).then(function(a){var n;"pdf"==c.filter.results_output.format?n=new l([a.data],{type:"application/pdf"}):"xlsx"==c.filter.results_output.format?n=new l([a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}):(t.displayFlashMessages("Error when downloading file.","error"),t.loadingState=!1),n.size&&r.saveAs(n,e.date+" "+e.name+" "+e.translations.results_list_singular+"."+c.filter.results_output.format),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},c.downloadResultsTeamsList=function(e){t.loadingState=!0,o.downloadResultsTeamsList(e.id).then(function(a){var n=new l([a.data],{type:"application/pdf"});n.size&&r.saveAs(n,e.date+" "+e.name+" "+e.translations.results_list_singular+".pdf"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},c.downloadShootingcards=function(e,a){t.loadingState=!0,o.downloadShootingcards(e.id,a).then(function(a){var n=new l([a.data],{type:"application/pdf"});n.size&&r.saveAs(n,e.date+" "+e.name+" "+e.translations.shootingcards+".pdf"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},c.downloadTeamsList=function(e,a){t.loadingState=!0,i.downloadTeamsList(e.id,a).then(function(a){var n=new l([a.data],{type:"application/pdf"});n.size&&r.saveAs(n,e.date+" "+e.name+" "+e.translations.shootingcards+".pdf"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},c.updateCompetition=function(e){t.loadingState=!0,s.save(e).then(function(a){e=a.data.competition,e.start_time=moment(e.start_time,"HH:mm:ss"),e.final_time=moment(e.final_time,"HH:mm:ss"),t.loadingState=!1},function(){t.loadingState=!1})}}]),angular.module("app.competitions.admin.invoices",[]).controller("CompetitionsAdminInvoiceController",["$rootScope","$stateParams","$state","CompetitionsAdminInvoicesFactory","FileSaver","Blob",function(t,e,a,n,i,o){function s(){t.loadingState=!0,n.find(e.competitions_id,e.id).then(function(e){e.data.invoice||a.go("admin.invoices.index"),r.invoice=e.data.invoice,r.hideSignups=!0,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}var r=this;r.download=function(t){n.download(e.competitions_id,t.id).then(function(e){var a=new o([e.data],{type:"application/pdf"});a.size&&i.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})},s()}]).factory("CompetitionsAdminInvoicesFactory",["$http","ApiEndpointUrl",function(t,e){return{find:function(a,n){return t({method:"GET",url:e+"competitions/"+a+"/admin/invoices/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},download:function(a,n){if(n)return t({method:"GET",url:e+"competitions/"+a+"/admin/invoices/"+n+"/download",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.admin",[]).controller("CompetitionsAdminController",["$rootScope","$scope","$stateParams","$uibModal","$state","CompetitionsAdminFactory",function(t,e,a,n,i,o){var s=this;e.find=function(){t.loadingState=!0,o.find(a.competitions_id).then(function(e){s.available_clubs=e.data.available_clubs,s.competition=e.data.competition,s.competition_types=e.data.competition_types,s.results_types=e.data.results_types,s.championships=e.data.championships,s.competition.start_time=moment(s.competition.start_time,"HH:mm:ss"),s.competition.final_time=moment(s.competition.final_time,"HH:mm:ss"),t.loadingState=!1},function(){i.go("competitions",{},{location:"replace"}),t.loadingState=!1})},e.find(),s.update=function(){t.loadingState=!0,o.save(s.competition).then(function(e){s.competition=e.data.competition,s.competition.start_time=moment(s.competition.start_time,"HH:mm:ss"),s.competition.final_time=moment(s.competition.final_time,"HH:mm:ss"),t.displayFlashMessages(e.data.message,"success"),t.loadingState=!1},function(){t.loadingState=!1})},s.openCreateChampionshipsModal=function(){var t=n.open({animation:!0,templateUrl:"CreateChampionshipModal.html",controller:"CreateChampionshipModalController as modalcontroller",size:"md"});t.result.then(function(t){s.championships.push(t.championship),s.competition.championships_id=t.championship.id})},s.close=function(){return!!a.competitions_id&&(t.loadingState=!0,void o.close(a.competitions_id).then(function(e){t.displayFlashMessages(e.data.message,"success"),s.competition.closed_at=e.data.closed_at,i.go("competitions.admin.index",{competitions_id:a.competitions_id},{location:"reload"}),t.loadingState=!1}))}}]).factory("CompetitionsAdminFactory",["$http","ApiEndpointUrl",function(t,e){return{find:function(a){return t({method:"GET",url:e+"competitions/"+a+"/admin",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},save:function(a){return data=angular.copy(a),a.start_time&&(data.start_time=moment(a.start_time).format("HH:mm:ss")),a.final_time&&(data.final_time=moment(a.final_time).format("HH:mm:ss")),a.date&&(data.date=moment(a.date).format("YYYY-MM-DD")),a.signups_opening_date&&(data.signups_opening_date=moment(a.signups_opening_date).format("YYYY-MM-DD")),a.signups_closing_date&&(data.signups_closing_date=moment(a.signups_closing_date).format("YYYY-MM-DD")),t({method:"PUT",url:e+"competitions/"+a.id+"/admin",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(data)})},close:function(a){return t({method:"POST",url:e+"competitions/"+a+"/admin/close",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.admin.patrols",[]).controller("CompetitionsAdminPatrolsController",["$rootScope","$scope","$stateParams","$state","$uibModal","CompetitionsAdminPatrolsFactory","FileSaver","Blob",function(t,e,a,n,i,o,s,r){var l=this;l.getPatrols=function(){t.loadingState=!0,o.getPatrols(a.competitions_id,{patrol_type:a.patrol_type}).then(function(e){l.patrols=e.data.patrols,t.loadingState=!1},function(){n.go("competitions.admin.patrols.index",{competitions_id:a.competitions_id},{location:"replace"}),t.loadingState=!1})},l.getPatrols(),l.generatePatrols=function(e){t.loadingState=!0,o.generatePatrols(a.competitions_id,{patrol_type:a.patrol_type},e).then(function(e){l.patrols=e.data.patrols,t.loadingState=!1},function(){n.go("competitions.admin.patrols.index",{competitions_id:a.competitions_id,patrol_type:"finals"},{location:"replace"}),t.loadingState=!1})}}]).controller("CompetitionsAdminPatrolsEditController",["$rootScope","$scope","$stateParams","$state","$uibModal","CompetitionsAdminPatrolsFactory","FileSaver","Blob",function(t,e,a,n,i,o,s,r){var l=this;l.active_patrol_id=0,l.filter={show:!1,shooting_card_number:"",share_patrol_with:"",first_last_patrol:"",start_before:"",start_after:"",possible_collision:"",weapongroups_id:"",orderby:"clubs_id",current_page:1,per_page:30},l.getPatrols=function(){t.loadingState=!0,o.getPatrolsExtended(a.competitions_id).then(function(e){l.patrols=e.data.patrols,l.signups=e.data.signups,l.setAvailableLanes(),t.loadingState=!1},function(){n.go("competitions.admin",{competitions_id:a.competitions_id},{location:"replace"}),t.loadingState=!1})},l.setActivePatrol=function(t){l.active_patrol_id=l.active_patrol_id!=t?t:0},l.openPatrolEditModal=function(t,e){var a=i.open({animation:!0,templateUrl:"PatrolEditModal.html",controller:"PatrolEditModalController as modalcontroller",size:"lg",resolve:{patrol:function(){return t},competition:function(){return e}}});a.result.then(function(e){t.patrol_size=e.patrol.patrol_size,t.start_time=e.patrol.start_time,t.end_time=e.patrol.end_time,t.start_time_human=e.patrol.start_time_human,t.end_time_human=e.patrol.end_time_human,angular.forEach(e.patrol.signups,function(t,e){l.updateCollidingSignups(t)})})},l.generatePatrols=function(){t.loadingState=!0,o.generatePatrols(a.competitions_id,[]).then(function(e){e.data.patrols.length&&angular.forEach(e.data.patrols,function(t,e){l.patrols.push(t)}),l.signups=e.data.signups,l.setAvailableLanes(),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},l.createPatrol=function(){l.loadingState=!0,o.createPatrol(a.competitions_id).then(function(t){l.patrols.push(t.data.patrol),l.setAvailableLanes(),l.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),l.loadingState=!1})},l.deletePatrol=function(e){l.loadingState=!0,o.deletePatrol(a.competitions_id,e.id).then(function(t){l.patrols.splice(l.patrols.indexOf(e),1),t.data.signups&&angular.forEach(t.data.signups,function(t,e){l.signups.push(t)}),l.active_patrol_id=0,l.setAvailableLanes(),l.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),l.loadingState=!1})},l.deleteAllPatrols=function(){t.loadingState=!0,o.deleteAllPatrols(a.competitions_id).then(function(e){l.patrols=[],l.signups=e.data.signups,l.active_patrol_id=0,l.setAvailableLanes(),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},l.emptyPatrol=function(e){l.loadingState=!0,o.emptyPatrol(a.competitions_id,e.id).then(function(t){t.data.signups&&angular.forEach(t.data.signups,function(t,e){t.lane=0,t.patrols_id=0,l.signups.push(t)}),e.signups=[],l.setAvailableLanes(),l.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),l.loadingState=!1})},l.updateSignupLane=function(e){e.new_lane&&o.updateSignupLane(a.competitions_id,e).then(function(t){e.lane=t.data.signup.lane,l.setAvailableLanes(),l.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),l.loadingState=!1})},l.associateSignupWithPatrol=function(e,n){e>0&&n&&!l.loadingState&&(l.loadingState=!0,o.associateSignupWithPatrol(a.competitions_id,e,n.id,n.lane).then(function(t){if(t.data.signup.lane){angular.forEach(l.patrols,function(a,i){a.id==e&&(n.patrols_id=e,n.lane=t.data.signup.lane,a.signups.push(n))});var a=l.signups.indexOf(n);l.signups.splice(a,1),l.updateCollidingSignups(t.data.signup),l.setAvailableLanes()}l.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),l.loadingState=!1}))},l.dissociateSignupWithPatrol=function(e,n){e&&n&&!l.loadingState&&(l.loadingState=!0,o.dissociateSignupWithPatrol(a.competitions_id,e.id,n.id).then(function(t){n.patrols_id=0,n.lane=0,l.signups.push(n);var a=e.signups.indexOf(n);e.signups.splice(a,1),l.updateCollidingSignups(t.data.signup),l.setAvailableLanes(),l.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),l.loadingState=!1}))},l.sharePatrolWith=function(t,e){angular.forEach(l.signups,function(a,n){a.user.shooting_card_number==e&&l.associateSignupWithPatrol(t,a)})},l.updateCollidingSignups=function(t){angular.forEach(l.signups,function(e,a){e.colliding_signups.length&&angular.forEach(e.colliding_signups,function(e,a){e.id==t.id&&(e.start_time=t.start_time,e.end_time=t.end_time,e.start_time_human=t.start_time_human,e.end_time_human=t.end_time_human,e.patrols_id=t.patrols_id)})}),angular.forEach(l.patrols,function(e,a){angular.forEach(e.signups,function(e,a){angular.forEach(e.colliding_signups,function(e,a){e.id==t.id&&(e.start_time=t.start_time,e.end_time=t.end_time,e.start_time_human=t.start_time_human,e.end_time_human=t.end_time_human,e.patrols_id=t.patrols_id)})})})},l.setAvailableLanes=function(){angular.forEach(l.patrols,function(t,e){t.available_lanes=[];for(var a=1;a<t.patrol_size+1;a++)t.available_lanes.push(a);angular.forEach(t.signups,function(e,a){var n=t.available_lanes.indexOf(e.lane);n!=-1&&t.available_lanes.splice(n,1)})})},l.filterStartAfter=function(t,e){return!e||t>=e},l.filterStartBefore=function(t,e){return!e||t<=e},l.filterPossibleCollision=function(t){return"yes"==l.filter.possible_collision?!(!t.colliding_signups.length&&!t.possible_finals.length):"no"!=l.filter.possible_collision||!t.colliding_signups.length&&!t.possible_finals.length},l.downloadPatrolsList=function(e){t.loadingState=!0,o.downloadPatrolsList(e.id).then(function(a){var n=new r([a.data],{type:"application/pdf"});n.size&&s.saveAs(n,e.date+" "+e.name+" "+e.translations.patrols_list_singular+".pdf"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},l.getPatrols()}]).controller("PatrolEditModalController",["$scope","$stateParams","$uibModalInstance","patrol","competition","CompetitionsAdminPatrolsFactory",function(t,e,a,n,i,o){var s=this;s.competition=i,s.options={showWeeks:!0,startingDay:1,maxDate:new Date};var r=moment(n.start_time),l=moment(n.end_time),c=l.diff(r,"hours");s.patrol={start_time:r,end_time:l,length_time:c,id:n.id,patrol_size:n.patrol_size,competitions_id:n.competitions_id},s.updatePatrol=function(t){s.loadingState||(s.loadingState=!0,o.savePatrol(e.competitions_id,t).then(function(t){a.close(t.data),s.loadingState=!1}))},s.changeTime=function(t){if(s.patrol.end_time<s.patrol.start_time&&(s.patrol.end_time=moment(s.patrol.start_time).add(1,"day").format("YYYY-MM-DD HH:mm")),"start"==t)s.patrol.end_time=moment(s.patrol.start_time).add(s.patrol.length_time,"hours").format("YYYY-MM-DD HH:mm");else if("end"==t){var e=moment(s.patrol.start_time),a=moment(s.patrol.end_time),n=a.diff(e,"hours",!0);s.patrol.length_time=n}else"length"==t&&(s.patrol.end_time=moment(s.patrol.start_time).add(s.patrol.length_time,"hours").format("YYYY-MM-DD HH:mm"))},s.cancel=function(){a.dismiss("cancel")}}]).factory("CompetitionsAdminPatrolsFactory",["$http","ApiEndpointUrl",function(t,e){return{getPatrols:function(a,n){var i=e+"competitions/"+a+"/admin/patrols";return n.patrol_type&&(i+="?patrol_type="+n.patrol_type),t({method:"GET",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},getPatrolsExtended:function(a){return t({method:"GET",url:e+"competitions/"+a+"/admin/patrolsextended",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},savePatrol:function(a,n){var i=angular.copy(n);return i.start_time=moment(n.start_time).format("YYYY-MM-DD HH:mm:00"),i.end_time=moment(n.end_time).format("YYYY-MM-DD HH:mm:00"),i.length_time=0,t({method:"PUT",url:e+"competitions/"+a+"/admin/patrols/"+n.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)})},generatePatrols:function(a,n,i){var o={},s=e+"competitions/"+a+"/admin/patrols/generate";return n.patrol_type&&(s+="/"+n.patrol_type),i&&(o.formdata=i),t({method:"POST",url:s,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(o)})},createPatrol:function(a){return t({method:"POST",url:e+"competitions/"+a+"/admin/patrols",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},deletePatrol:function(a,n){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/patrols/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},deleteAllPatrols:function(a){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/patrols/all",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},emptyPatrol:function(a,n){return t({method:"POST",url:e+"competitions/"+a+"/admin/patrols/"+n+"/empty",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},updateSignupLane:function(a,n){return data={lane:n.new_lane},t({method:"PUT",url:e+"competitions/"+a+"/admin/signups/"+n.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(data)})},associateSignupWithPatrol:function(a,n,i,o){return t({method:"POST",url:e+"competitions/"+a+"/admin/patrols/signups",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({patrols_id:n,signups_id:i,lane:o})})},dissociateSignupWithPatrol:function(a,n,i){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/patrols/signups",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({patrols_id:n,signups_id:i})})},downloadPatrolsList:function(a,n){var i=n?n:{};if(a)return t({method:"POST",url:e+"competitions/"+a+"/admin/patrols/export",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)})},downloadSignupsList:function(a,n){if(a)return t({method:"POST",url:e+"competitions/"+a+"/admin/export/signups",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},downloadSignupsListAsXlsx:function(a){if(a)return t({method:"POST",url:e+"competitions/"+a+"/admin/export/signups/xlsx",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},downloadTeamsList:function(a,n){var i=n?n:{};if(a)return t({method:"POST",url:e+"competitions/"+a+"/admin/export/teams",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)})}}}]),angular.module("app.competitions.admin.results.prices",[]).controller("CompetitionsAdminResultsPricesController",["$rootScope","$scope","$stateParams","$state","$timeout","CompetitionsAdminResultsPricesFactory",function(t,e,a,n,i,o){var s=this;s.load=function(){t.loadingState=!0,o.load(a.competitions_id).then(function(e){s.results=e.data.results,t.loadingState=!1})},s.savePrice=function(t){t.updating=!0;var e={price:t.price,placement:t.placement};o.savePrice(a.competitions_id,t.id,e).then(function(e){t.price=e.data.price,t.placement=e.data.placement,t.updating=!1})},s.load()}]).factory("CompetitionsAdminResultsPricesFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"competitions/"+a+"/admin/results/prices";return t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},savePrice:function(a,n,i){var o=e+"competitions/"+a+"/admin/results/prices/"+n;return t({method:"PUT",url:o,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)})}}}]),angular.module("app.competitions.admin.results",[]).controller("CompetitionsAdminResultsRegistrationController",["$rootScope","$scope","$stateParams","$state","$uibModal","CompetitionsAdminResultsFactory",function(t,e,a,n,i,o){
var s=this;s.filter={patrol:parseInt(a.patrol),patrol_type:a.patrol_type,station_start:parseInt(a.station_start),station_end:parseInt(a.station_end),lane_start:parseInt(a.lane_start),lane_end:parseInt(a.lane_end),show_empty_lanes:parseInt(a.show_empty_lanes),per_shot:parseInt(a.per_shot)},s.editingSignup=null,s.originalResults=null,s.load=function(){o.load(a.competitions_id,s.filter).then(function(t){s.signups=t.data.signups,s.stations=t.data.stations,s.patrols=t.data.patrols})},s.load(),s.save=function(t,e){if(t.error="",!s.loadingState&&s.editingSignup.id===t.id){s.loadingState=!0;for(var n=0;n<t.results.length;n++)delete t.results[n].created_at,delete t.results[n].updated_at,delete t.results[n].deleted_at;o.save(a.competitions_id,s.filter,t.results).then(function(a){t.alert=a.data,t.error="",s.loadingState=!1,e===!0&&(s.editingSignup=null)})["catch"](function(e){t.error="Något gick fel när vi skulle spara resultaten. Försök igen.",s.loadingState=!1})}},s.closeAlert=function(t){t.alert=""},s.closeError=function(t){t.error=""},s.startEditing=function(t){s.originalResults=JSON.stringify(t.results),s.editingSignup=t},s.stopEditing=function(t){return!!s.changesAreConfirmed()&&(t.results=JSON.parse(s.originalResults),s.editingSignup=null,void(t.error=""))},s.changesAreConfirmed=function(){return null===s.editingSignup||s.originalResults===JSON.stringify(s.editingSignup.results)||confirm("Dina ändringar kommer inte sparas. Är du säker?")},window.onbeforeunload=function(t){return!!s.changesAreConfirmed()||(t.preventDefault(),!1)},t.$on("$stateChangeStart",function(t){s.changesAreConfirmed()||t.preventDefault()})}]).factory("CompetitionsAdminResultsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){return t({method:"POST",url:e+"competitions/"+a+"/admin/results/registration",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},save:function(a,n,i){return t({method:"PUT",url:e+"competitions/"+a+"/admin/results/registration",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({filter:n,results:i})})},downloadResultsList:function(a,n){if(a)return t({method:"POST",url:e+"competitions/"+a+"/admin/results/export",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},downloadResultsTeamsList:function(a){if(a)return t({method:"POST",url:e+"competitions/"+a+"/admin/results/teams",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},downloadShootingcards:function(a,n){if(a)return t({method:"POST",url:e+"competitions/"+a+"/admin/export/shootingcards",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})}}}]),angular.module("app.competitions.admin.signups",[]).controller("CompetitionsAdminSignupsController",["$rootScope","$scope","$stateParams","$state","$uibModal","CompetitionsAdminSignupsFactory",function(t,e,a,n,i,o){var s=this;s.load=function(){t.loadingState=!0;var e={current_page:a.current_page,per_page:a.per_page,search:a.search,status:a.status,invoice:a.invoice};o.load(a.competitions_id,e).then(function(e){s.signups=e.data.signups,s.signups.invoice=a.invoice,t.loadingState=!1})},s.updatePage=function(){var t={competitions_id:a.competitions_id,search:s.signups.search,status:s.signups.status,current_page:s.signups.current_page,per_page:s.signups.per_page,invoice:s.signups.invoice};n.go("competitions.admin.signups.index",t,{location:"replace"})},s.openUserSearchModal=function(){i.open({templateUrl:"userSearchModal.html",controller:"CompetitionsAdminUsersModalController as usersearch",size:"md"})},s.load(),s.createInvoice=function(e,n){t.loadingState=!0;var i={signups_id:e.id,paid:n};o.createInvoice(a.competitions_id,i).then(function(a){e.invoice=a.data.invoice,t.loadingState=!1})},s.openPaymentModal=function(t){var e=i.open({animation:!0,templateUrl:"ClubInvoicePaymentModal.html",controller:"ClubInvoicePaymentModalController as modalcontroller",size:"md",resolve:{invoice:function(){return t}}});e.result.then(function(e){t.paid_at="1234"})},s.approveSignup=function(t){o.approveSignup(a.competitions_id,t.id).then(function(e){t.is_approved_by=e.data.signup.is_approved_by})},s.download=function(t){ClubInvoicesFactory.download(t.id).then(function(e){var a=new Blob([e.data],{type:"application/pdf"});a.size&&FileSaver.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})}}]).controller("CompetitionsAdminUsersModalController",["$rootScope","$stateParams","$state","$uibModalInstance","CompetitionsAdminUsersFactory","ClubsFactory",function(t,e,a,n,i,o){var s=this;s.search="",s.create_user=!1,s.newUser={},s.searchQuery="",s.new_club=null,s.add_clubs_nr="",s.changeClub=!1,s.noMatchingClubs=!1,s.searchForUser=function(){if(s.search){s.loadingState=!0;var t={search:s.search};i.searchForUser(e.competitions_id,t).then(function(t){s.users=t.data.users,s.noresults=!t.data.users.length,s.loadingState=!1})}},s.selectUser=function(t){n.close(),a.go("competitions.admin.users.show",{user_id:t})},s.searchForClubs=function(e,a){return o.searchForClubs(e).then(function(t){return s.foundMatch=t.data.clubs.length>0,t.data.clubs.map(function(t){return t.alreadySelected=!1,angular.forEach(a,function(e){e.id==t.id&&(t.alreadySelected=!0)}),t})},function(e){t.displayFlashMessages(e.data,"warning")})},s.selectClub=function(t){return t.alreadySelected!==!0&&(s.noMatchingClubs=null,s.new_club=t,void(s.newUser.clubs_id=t.id))},s.createuser=function(){s.noMatchingClubs?(s.newUser.clubs_id=null,s.newUser.create_club=!0,s.newUser.club_name=s.searchQuery):(s.newUser.club_name=null,s.newUser.create_club=!1),i.createUser(e.competitions_id,s.newUser).then(function(t){n.close(),a.go("competitions.admin.users.show",{user_id:t.data.user.user_id})},function(e){t.displayFlashMessages(e.data,"error")})},s.closeModal=function(){n.dismiss("cancel")}}]).factory("CompetitionsAdminSignupsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){var i=e+"competitions/"+a+"/admin/signups";return current_page=n.current_page?n.current_page:1,i+="?page="+current_page,n.search&&(i+="&search="+n.search),n.status&&(i+="&status="+n.status),n.per_page&&(i+="&per_page="+n.per_page),n.specialwishes&&(i+="&status="+n.specialwishes),n.invoice&&(i+="&invoice="+n.invoice),t({method:"GET",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},approveSignup:function(a,n){var i=e+"competitions/"+a+"/admin/signups/"+n+"/approve";return t({method:"PUT",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createInvoice:function(a,n){var i=e+"competitions/"+a+"/admin/invoice";return t({method:"POST",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})}}}]),angular.module("app.competitions.admin.stations",[]).controller("CompetitionsAdminStationsController",["$rootScope","$scope","$stateParams","$state","$uibModal","CompetitionsAdminStationsFactory",function(t,e,a,n,i,o){var s=this;s.getStations=function(){t.loadingState=!0,o.getStations(a.competitions_id).then(function(e){s.stations=e.data.stations,t.loadingState=!1},function(){n.go("competitions.admin",{competitions_id:a.competitions_id},{location:"replace"}),t.loadingState=!1})},s.getStations(),s.openStationEditModal=function(t,e){var a=i.open({animation:!0,templateUrl:"StationEditModal.html",controller:"StationEditModalController as modalcontroller",size:"lg",resolve:{station:function(){return t},competition:function(){return e}}});a.result.then(function(t){s.stations=t.stations}),a.dismiss(function(){s.getStations()})},s.createStation=function(){s.loadingState=!0,o.createStation(a.competitions_id).then(function(t){s.stations=t.data.stations,s.loadingState=!1},function(){n.go("competitions.admin.stations",{competitions_id:a.competitions_id},{location:"replace"}),s.loadingState=!1})},s.deleteStation=function(t){s.loadingState=!0,o.deleteStation(a.competitions_id,t.id).then(function(t){s.stations=t.data.stations,s.loadingState=!1},function(){n.go("competitions.admin.stations",{competitions_id:a.competitions_id},{location:"replace"}),s.loadingState=!1})}}]).controller("StationEditModalController",["$scope","$stateParams","$uibModalInstance","station","competition","CompetitionsAdminStationsFactory",function(t,e,a,n,i,o){var s=this;s.competition=i,s.station=angular.copy(n),s.updateStation=function(t){s.loadingState||(s.loadingState=!0,o.saveStation(e.competitions_id,t).then(function(t){a.close(t.data),s.loadingState=!1}))},s.cancel=function(){a.dismiss("cancel")}}]).factory("CompetitionsAdminStationsFactory",["$http","ApiEndpointUrl",function(t,e){return{getStations:function(a){return t({method:"GET",url:e+"competitions/"+a+"/admin/stations",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},saveStation:function(a,n){return data=angular.copy(n),t({method:"PUT",url:e+"competitions/"+a+"/admin/stations/"+n.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(data)})},createStation:function(a){return t({method:"POST",url:e+"competitions/"+a+"/admin/stations",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},deleteStation:function(a,n){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/stations/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},deleteAllStations:function(a){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/stations/all",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.admin.teams",[]).controller("CompetitionsAdminTeamsController",["$rootScope","$scope","$stateParams","$state","CompetitionsFactory","CompetitionsAdminTeamSignupsFactory",function(t,e,a,n,i,o){var s=this;s.searchQuery="",s.selectedClub=null,s.findCompetition=function(){t.loadingState=!0,i.find(a.competitions_id).then(function(e){s.competitions=e.data.competitions,s.competitions.google_maps&&(s.competitions.google_maps_url=$sce.trustAsResourceUrl(s.competitions.google_maps)),t.loadingState=!1},function(){t.loadingState=!1})},s.getCompetitionTeams=function(){t.loadingState=!0,o.loadCompetitionTeams(a.competitions_id).then(function(e){s.teams=e.data.teams,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},s.findCompetition(),s.getCompetitionTeams(),s.deleteTeam=function(e){return!!e&&void o["delete"](a.competitions_id,e).then(function(e){t.displayFlashMessages(e.data),window.location.reload()},function(e){t.displayFlashMessages(e.data.message,"error")})},s.cancelTeam=function(){n.go("competitions.admin.teamsignups.index",{id:a.competitions_id},{reload:!0})}}]).controller("CompetitionsAdminTeamSignupsCreateController",["$rootScope","$scope","$stateParams","$state","CompetitionsAdminTeamSignupsFactory","CompetitionsFactory","ClubsFactory",function(t,e,a,n,i,o,s){var r=this;r.findCompetition=function(){o.find(a.competitions_id).then(function(t){r.competitions=t.data.competitions})},r.findCompetition(),r.createTeam=function(){r.addTeam.name&&r.addTeam.weapongroups_id&&i.store(a.competitions_id,r.addTeam).then(function(e){t.displayFlashMessages(e.data.message),n.go("competitions.admin.teamsignups.index",{reload:!0})},function(e){t.displayFlashMessages(e.data.message,"error"),e.data.redirect_to_edit&&n.go("competitions.admin.teamsignups.edit",{id:a.id,teams_id:e.data.redirect_to_edit},{reload:!0})})},r.searchForClubs=function(e,a){return s.searchForClubs(e).then(function(t){return t.data.clubs},function(e){t.displayFlashMessages(e.data,"warning")})},r.selectClub=function(t){r.selectedClub=t,r.getTeamSlots()},r.getTeamSlots=function(){i.loadTeamSlots(a.competitions_id,r.selectedClub.id).then(function(e){r.addTeam={name:"",weapongroups_id:"",clubs_id:r.selectedClub.id,teams_signups_first:null,teams_signups_second:null,teams_signups_third:null,teams_signups_fourth:null,teams_signups_fifth:null},r.teams=e.data.teams,r.signups_ordinary_available=e.data.signups_ordinary_available,r.signups_reserve_available=e.data.signups_reserve_available,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}}]).controller("CompetitionsAdminTeamSignupController",["$rootScope","$scope","$stateParams","$state","CompetitionsAdminTeamSignupsFactory","CompetitionsFactory",function(t,e,a,n,i,o){var s=this;s.findTeam=function(){o.find(a.competitions_id).then(function(t){s.competitions=t.data.competitions}),i.findTeam(a.competitions_id,a.teams_id).then(function(e){s.teams=e.data.teams,s.signups_ordinary_available=e.data.signups_ordinary_available,s.signups_reserve_available=e.data.signups_reserve_available,angular.forEach(s.teams.signups,function(t,e){1==t.pivot.position&&(s.teams.teams_signups_first=t.id),2==t.pivot.position&&(s.teams.teams_signups_second=t.id),3==t.pivot.position&&(s.teams.teams_signups_third=t.id),4==t.pivot.position&&(s.teams.teams_signups_fourth=t.id),5==t.pivot.position&&(s.teams.teams_signups_fifth=t.id)}),s.teams.signups=null,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},s.updateTeam=function(e){s.teams.name&&s.teams.weapongroups_id&&i.update(a.competitions_id,s.teams.id,e).then(function(e){t.displayFlashMessages(e.data.message),n.go("competitions.admin.teamsignups.index",{reload:!0})},function(e){t.displayFlashMessages(e.data.message,"error"),e.data.redirect_to_edit&&n.go("competitions.admin.teamsignups.edit",{id:a.competitions_id,teams_id:e.data.redirect_to_edit},{reload:!0})})},s.cancelTeam=function(){n.go("competitions.admin.teamsignups.index",{id:a.competitions_id},{reload:!0})},s.findTeam()}]).factory("CompetitionsAdminTeamSignupsFactory",["$http","ApiEndpointUrl",function(t,e){return{update:function(a,n,i){return t({method:"PUT",url:e+"competitions/"+a+"/admin/teamsignups/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)})},store:function(a,n){return t({method:"POST",url:e+"competitions/"+a+"/admin/teamsignups",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},loadCompetitionTeams:function(a){return t({method:"GET",url:e+"competitions/"+a+"/admin/teamsignups",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},findTeam:function(a,n){return t({method:"GET",url:e+"competitions/"+a+"/admin/teamsignups/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},loadTeamSlots:function(a,n){return t({method:"GET",url:e+"competitions/"+a+"/admin/teamsignups/create?clubs_id="+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},"delete":function(a,n){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/teamsignups/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.admin.users",[]).controller("CompetitionsAdminUsersController",["$rootScope","$scope","$stateParams","$state","$uibModal","CompetitionsAdminUsersFactory",function(t,e,a,n,i,o){var s=this;s.loadUser=function(){t.loadingState=!0,o.load(a.competitions_id,a.user_id).then(function(e){s.user=e.data.user,t.loadingState=!1})},s.createSignup=function(e){if(s.loadingState)return!1;s.loadingState=!0;var n={competitions_id:a.competitions_id,weaponclasses_id:e,users_id:a.user_id};o.createSignup(a.competitions_id,n).then(function(t){t.data.weaponclasses_id=parseInt(t.data.weaponclasses_id),s.user.signups.push(t.data),s.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),s.loadingState=!1})},s.deleteSignup=function(e){return!s.loadingState&&(s.loadingState=!0,void o.deleteSignup(a.competitions_id,e).then(function(t){angular.forEach(s.user.signups,function(t,a){t.id==e.id&&s.user.signups.splice(a,1)}),s.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),s.loadingState=!1}))},s.changeSignupWeaponclass=function(t,e){o.changeSignupWeaponclass(a.competitions_id,e,t).then(function(){s.loadUser()})},s.loadUser()}]).factory("CompetitionsAdminUsersFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){var i=e+"competitions/"+a+"/admin/users/"+n;return t({method:"GET",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},searchForUser:function(a,n){var i=e+"competitions/"+a+"/admin/users";return n.search&&(i+="?search="+n.search),t({method:"GET",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createUser:function(a,n){return t({method:"POST",url:e+"competitions/"+a+"/admin/users",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},createSignup:function(a,n){return t({method:"POST",url:e+"competitions/"+a+"/admin/signups",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},deleteSignup:function(a,n){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/signups/"+n.id,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},changeSignupWeaponclass:function(a,n,i){return data=angular.copy(n),data.weaponclasses_id=i,t({method:"PUT",url:e+"competitions/"+a+"/admin/signups/"+n.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(data)})}}}]),angular.module("app.competitions.admin.weaponclasses",[]).controller("CompetitionsAdminWeaponclassesController",["$rootScope","$scope","$stateParams","$state","$uibModal","CompetitionsAdminWeaponclassesFactory",function(t,e,a,n,i,o){var s=this;s.getWeaponclasses=function(){t.loadingState=!0,o.getWeaponclasses(a.competitions_id).then(function(e){s.allweaponclasses=e.data.allweaponclasses,s.weaponclasses=e.data.weaponclasses,s.newWeaponclass={competitions_id:a.competitions_id,registration_fee:200,weaponclasses_id:null},t.loadingState=!1},function(){n.go("competitions.admin",{competitions_id:a.competitions_id},{location:"replace"}),t.loadingState=!1})},s.getWeaponclasses(),s.openWeaponclassEditModal=function(t,e){var a=i.open({animation:!0,templateUrl:"WeaponclassEditModal.html",controller:"WeaponclassEditModalController as modalcontroller",size:"sm",resolve:{weaponclass:function(){return t},competition:function(){return e}}});a.result.then(function(t){s.weaponclasses=t.weaponclasses}),a.dismiss(function(){s.getWeaponclasses()})},s.createWeaponclass=function(){s.loadingState=!0,o.createWeaponclass(a.competitions_id,this.newWeaponclass).then(function(t){s.weaponclasses=t.data.weaponclasses,s.loadingState=!1},function(){n.go("competitions.admin.weaponclasses",{competitions_id:a.competitions_id},{location:"replace"}),s.loadingState=!1})},s.deleteWeaponclass=function(t){s.loadingState=!0,o.deleteWeaponclass(a.competitions_id,t.id).then(function(t){s.weaponclasses=t.data.weaponclasses,s.loadingState=!1},function(){n.go("competitions.admin.weaponclasses",{competitions_id:a.competitions_id},{location:"replace"}),s.loadingState=!1})}}]).controller("WeaponclassEditModalController",["$scope","$stateParams","$uibModalInstance","weaponclass","competition","CompetitionsAdminWeaponclassesFactory",function(t,e,a,n,i,o){var s=this;s.competition=i,s.weaponclass=angular.copy(n),s.updateWeaponclass=function(t){s.loadingState||(s.loadingState=!0,o.saveWeaponclass(e.competitions_id,t).then(function(t){a.close(t.data),s.loadingState=!1}))},s.cancel=function(){a.dismiss("cancel")}}]).factory("CompetitionsAdminWeaponclassesFactory",["$http","ApiEndpointUrl",function(t,e){return{getWeaponclasses:function(a){return t({method:"GET",url:e+"competitions/"+a+"/admin/weaponclasses",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},saveWeaponclass:function(a,n){return data=angular.copy(n),t({method:"PUT",url:e+"competitions/"+a+"/admin/weaponclasses/"+n.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(data)})},createWeaponclass:function(a,n){return data=angular.copy(n),t({method:"POST",url:e+"competitions/"+a+"/admin/weaponclasses",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(data)})},deleteWeaponclass:function(a,n){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/weaponclasses/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},deleteAllWeaponclasses:function(a){return t({method:"DELETE",url:e+"competitions/"+a+"/admin/weaponclasses/all",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.create",[]).controller("CompetitionsCreateController",["$rootScope","$scope","$stateParams","$uibModal","$state","CompetitionsCreateFactory",function(t,e,a,n,i,o){var s=this;s.wizard={current_step:1,max_steps:8},s.newWeaponclass={weaponclass:{},registration_fee:200,weaponclasses_id:null},s.create=function(){t.loadingState=!0,o.create().then(function(e){s.available_clubs=e.data.available_clubs,s.competition=e.data.competition,s.competition.organizer_id=e.data.competition.organizer_id,s.competition_types=e.data.competition_types,s.results_types=e.data.results_types,s.championships=e.data.championships,s.weaponclasses=e.data.weaponclasses,s.competition.date_human=moment(s.competition.date,"YYYY-MM-DD").format("YYYY-MM-DD"),s.competition.signups_opening_date_human=moment(s.competition.signups_opening_date,"YYYY-MM-DD").format("YYYY-MM-DD"),s.competition.signups_closing_date_human=moment(s.competition.signups_closing_date,"YYYY-MM-DD").format("YYYY-MM-DD"),s.competition.start_time=moment(s.competition.start_time,"HH:mm:ss"),s.competition.final_time=moment(s.competition.final_time,"HH:mm:ss"),s.competition.start_time_human=moment(s.competition.start_time,"HH:mm:ss").format("HH:mm"),s.competition.final_time_human=moment(s.competition.final_time,"HH:mm:ss").format("HH.mm"),t.loadingState=!1},function(e){e.data.message?s.adminerror=e.data.message:i.go("competitions.create",{},{location:"replace"}),t.loadingState=!1})},s.create(),s.wizardStepForward=function(){s.wizard.current_step<s.wizard.max_steps&&(s.competition.date_human=moment(s.competition.date).format("YYYY-MM-DD"),s.competition.signups_opening_date_human=moment(s.competition.signups_opening_date).format("YYYY-MM-DD"),s.competition.signups_closing_date_human=moment(s.competition.signups_closing_date).format("YYYY-MM-DD"),s.competition.start_time_human=moment(s.competition.start_time,"HH:mm:ss").format("HH:mm"),s.competition.final_time_human=moment(s.competition.final_time,"HH:mm:ss").format("HH.mm"),s.wizard.current_step++)},s.wizardStepBackward=function(){s.wizard.current_step>1&&(s.competition.date_human=moment(s.competition.date).format("YYYY-MM-DD"),s.competition.signups_opening_date_human=moment(s.competition.signups_opening_date).format("YYYY-MM-DD"),s.competition.signups_closing_date_human=moment(s.competition.signups_closing_date).format("YYYY-MM-DD"),s.competition.start_time_human=moment(s.competition.start_time,"HH:mm:ss").format("HH:mm"),s.competition.final_time_human=moment(s.competition.final_time,"HH:mm:ss").format("HH.mm"),s.wizard.current_step--)},s.createWeaponclass=function(){var t=s.weaponclasses.indexOf(s.newWeaponclass.weaponclass),e=!1;if(t!==-1&&(angular.forEach(s.competition.weaponclasses,function(t,a){t.weaponclasses_id==s.newWeaponclass.weaponclass.id&&(e=!0)}),!e)){var a={weaponclasses_id:this.weaponclasses[t].id,registration_fee:this.newWeaponclass.registration_fee,classname:this.weaponclasses[t].classname,classname_general:this.weaponclasses[t].classname_general};s.competition.weaponclasses.push(a)}},s.deleteWeaponclass=function(t){var e=s.competition.weaponclasses.indexOf(t);s.competition.weaponclasses.splice(e,1)},s.save=function(){t.loadingState=!0,o.save(s.competition).then(function(e){s.competition.id=e.data.competitions_id,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},s.openCreateChampionshipsModal=function(){var t=n.open({animation:!0,templateUrl:"CreateChampionshipModal.html",controller:"CreateChampionshipModalController as modalcontroller",size:"md"});t.result.then(function(t){s.championships.push(t.championship),s.competition.championship=t.championship})}}]).controller("CreateChampionshipModalController",["$scope","$stateParams","$uibModalInstance","CompetitionsCreateFactory",function(t,e,a,n){var i=this;i.championship={name:""},i.save=function(){!i.loadingState&&i.championship.name&&(i.loadingState=!0,n.saveChampionship(i.championship).then(function(t){a.close(t.data),i.loadingState=!1}))},i.cancel=function(){a.dismiss("cancel")}}]).factory("CompetitionsCreateFactory",["$http","ApiEndpointUrl",function(t,e){return{create:function(){return t({method:"GET",url:e+"competitions/create",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},save:function(a){var n=angular.copy(a);return delete n.translations,delete n.results_type_human,n.competitiontype&&(n.competitiontypes_id=n.competitiontype.id,delete n.competitiontype),n.championship&&(n.championships_id=n.championship.id,delete n.championship),n.results_type&&(n.results_type=n.results_type.type),a.start_time&&(n.start_time=moment(a.start_time).format("HH:mm:ss")),a.final_time&&(n.final_time=moment(a.final_time).format("HH:mm:ss")),a.date&&(n.date=moment(a.date).format("YYYY-MM-DD")),a.signups_opening_date&&(n.signups_opening_date=moment(a.signups_opening_date).format("YYYY-MM-DD")),a.signups_closing_date&&(n.signups_closing_date=moment(a.signups_closing_date).format("YYYY-MM-DD")),t({method:"POST",url:e+"competitions",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},saveChampionship:function(a){return t({method:"POST",url:e+"championships",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})}}}]),angular.module("app.competitions",[]).controller("CompetitionsController",["$rootScope","$scope","$stateParams","$state","CompetitionsFactory",function(t,e,a,n,i){var o=this;o.load=function(e){t.loadingState=!0;var n={current_page:a.current_page,per_page:a.per_page,search:a.search,status:a.status,type:a.type,usersignup:a.usersignup};i.load(n).then(function(e){o.competitions=e.data.competitions,t.loadingState=!1})},o.updatePage=function(){var t={search:o.competitions.search,status:o.competitions.status,type:o.competitions.type,usersignup:o.competitions.usersignup,current_page:o.competitions.current_page,per_page:o.competitions.per_page};n.go("competitions",t,{location:"replace"})},o.load()}]).controller("CompetitionController",["$rootScope","$scope","$sce","$stateParams","$state","$timeout","CompetitionsFactory","SignupsFactory",function(t,e,a,n,i,o,s,r){function l(){t.loadingState=!0,s.find(n.id).then(function(e){c.competitions=e.data.competitions,c.competitions.google_maps&&(c.competitions.google_maps_url=a.trustAsResourceUrl(c.competitions.google_maps)),c.user=JSON.parse(localStorage.getItem("user")),t.loadingState=!1},function(){i.go("competitions",{},{location:"replace"}),t.loadingState=!1})}var c=this;c.createSignup=function(e){if(c.loadingState)return!1;c.loadingState=!0;var a={competitions_id:c.competitions.id,weaponclasses_id:e,users_id:c.user.user_id};r.createSignup(a).then(function(t){t.data.weaponclasses_id=parseInt(t.data.weaponclasses_id),c.competitions.usersignups.push(t.data),c.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),c.loadingState=!1})},c.deleteSignup=function(t){r.deleteSignup(t).then(function(){angular.forEach(c.competitions.usersignups,function(e,a){e.id==t.id&&c.competitions.usersignups.splice(a,1)})})},l()}]).factory("CompetitionsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){var i=e+"competitions";return current_page=a.current_page?a.current_page:1,!angular.isUndefined(n)&&n>0&&(i+="/"+n),i+="?page="+current_page,a.search&&(i+="&search="+a.search),a.per_page&&(i+="&per_page="+a.per_page),a.status&&(i+="&status="+a.status),a.type&&(i+="&type="+a.type),a.usersignup&&(i+="&usersignup="+a.usersignup),a.clubs_id&&(i+="&clubs_id="+a.clubs_id),t({method:"GET",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"competitions/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.patrols",[]).controller("CompetitionsPatrolsController",["$rootScope","$scope","$stateParams","$state","$timeout","CompetitionsPatrolsFactory",function(t,e,a,n,i,o){var s=this;s.load=function(){t.loadingState=!0,o.load(a.id).then(function(e){s.patrols=e.data.patrols,t.loadingState=!1,a.patrols_id&&(s.patrols_id=a.patrols_id,i(function(){var t=document.getElementById("patrol_"+s.patrols_id);t&&t.scrollIntoView()}))})},s.updatePage=function(){n.go("competition.patrols({competitions_id: $stateParams.id})",{},{location:"replace"})},s.load()}]).factory("CompetitionsPatrolsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"competitions/"+a+"/patrols";return t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.results",[]).controller("CompetitionsResultsController",["$rootScope","$scope","$stateParams","$state","$timeout","CompetitionsResultsFactory","FileSaver","Blob",function(t,e,a,n,i,o,s,r){var l=this;l.load=function(){t.loadingState=!0,o.load(a.id).then(function(e){l.results=e.data.results,t.loadingState=!1,a.signups_id&&(l.signups_id=a.signups_id,i(function(){var t=document.getElementById("signup_"+l.signups_id);t&&t.scrollIntoView()}))})},l.downloadResultsList=function(e){t.loadingState=!0,o.downloadResultsList(e.id).then(function(a){var n=new r([a.data],{type:"application/pdf"});n.size&&s.saveAs(n,e.date+" "+e.name+" "+e.translations.results_list_singular+".pdf"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},l.updatePage=function(){n.go("competitions.results({competitions_id: $stateParams.id})",{},{location:"replace"})},l.load()}]).factory("CompetitionsResultsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"competitions/"+a+"/results";return t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},downloadResultsList:function(a){if(a)return t({method:"POST",url:e+"competitions/"+a+"/results/export",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.signups",[]).controller("CompetitionsSignupsController",["$rootScope","$scope","$stateParams","$state","CompetitionsSignupsFactory",function(t,e,a,n,i){var o=this;o.load=function(){t.loadingState=!0;var e={current_page:a.current_page,per_page:a.per_page,search:a.search,status:a.status};i.load(a.id,e).then(function(e){o.signups=e.data.signups,t.loadingState=!1})},o.updatePage=function(){var t={id:a.id,search:o.signups.search,status:o.signups.status,current_page:o.signups.current_page,per_page:o.signups.per_page};n.go("competition.signups",t,{location:"replace"})},o.load()}]).factory("CompetitionsSignupsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){var i=e+"competitions/"+a+"/signups";return current_page=n.current_page?n.current_page:1,i+="?page="+current_page,n.search&&(i+="&search="+n.search),n.status&&(i+="&status="+n.status),n.per_page&&(i+="&per_page="+n.per_page),t({method:"GET",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.competitions.teams",[]).controller("CompetitionsTeamsController",["$rootScope","$scope","$stateParams","$state","$timeout","CompetitionsTeamsFactory",function(t,e,a,n,i,o){var s=this;s.load=function(){t.loadingState=!0,o.load(a.id).then(function(e){s.teams=e.data.teams,t.loadingState=!1,a.teams_id&&(s.teams_id=a.teams_id,i(function(){var t=document.getElementById("team_"+s.teams_id);t&&t.scrollIntoView()}))})},s.updatePage=function(){n.go("competition.teams({competitions_id: $stateParams.id})",{},{location:"replace"})},s.load()}]).factory("CompetitionsTeamsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"competitions/"+a+"/teams";return t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.dashboard",[]).controller("DashboardController",["$rootScope","$scope","$timeout",function(t,e,a){
t.loadingState=!0,e.$on("$viewContentLoaded",function(){a(function(){!function(t,e,a){FB=null;var n,i=t.getElementsByTagName(e)[0];n=t.createElement(e),n.id=a,n.src="//connect.facebook.net/sv_SE/sdk.js#xfbml=1&version=v2.6&appId=956867524398222",i.parentNode.insertBefore(n,i)}(document,"script","facebook-jssdk"),t.loadingState=!1},500)})}]),angular.module("app.districts.invoices",[]).controller("DistrictInvoicesController",["$rootScope","$stateParams","$state","DistrictInvoicesFactory","$uibModal","FileSaver","Blob","$filter",function(t,e,a,n,i,o,s,r){var l=this;l.argsToUrl=function(t){var e="";return t.direction&&(e+="&direction="+t.direction),t.search&&(e+="&search="+t.search),t.per_page&&(e+="&per_page="+t.per_page),t.payment_status&&(e+="&payment_status="+t.payment_status),t.orderby&&(e+="&orderby="+t.orderby),t.paid_at_start&&(e+="&paid_at_start="+t.paid_at_start),t.paid_at_end&&(e+="&paid_at_end="+t.paid_at_end),t.created_at_start&&(e+="&created_at_start="+t.created_at_start),t.created_at_end&&(e+="&created_at_end="+t.created_at_end),e},l.loadInvoices=function(){t.loadingState=!0;var a={direction:e.direction,current_page:e.current_page,per_page:e.per_page,search:e.search,payment_status:e.payment_status,orderby:e.orderby,paid_at_start:e.paid_at_start,paid_at_end:e.paid_at_end,created_at_start:e.created_at_start,created_at_end:e.created_at_end},i=a.current_page?a.current_page:1,o="?page="+i+l.argsToUrl(a);n.load(e.districts_id,o).then(function(a){l.invoices=a.data.invoices,l.invoices_generate=a.data.invoices_generate,l.hideSignups=!0,e.paid_at_start&&(l.invoices.paid_at_start=e.paid_at_start),e.paid_at_end&&(l.invoices.paid_at_end=e.paid_at_end),e.created_at_start&&(l.invoices.created_at_start=e.created_at_start),e.created_at_end&&(l.invoices.created_at_end=e.created_at_end),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},l.updatePage=function(){var t={districts_id:e.districts_id,direction:l.invoices.direction,search:l.invoices.search,payment_status:l.invoices.payment_status,current_page:l.invoices.current_page,per_page:l.invoices.per_page,orderby:l.invoices.orderby,paid_at_start:r("date")(l.invoices.paid_at_start,"yyyy-MM-dd"),paid_at_end:r("date")(l.invoices.paid_at_end,"yyyy-MM-dd"),created_at_start:r("date")(l.invoices.created_at_start,"yyyy-MM-dd"),created_at_end:r("date")(l.invoices.created_at_end,"yyyy-MM-dd")};"outgoing"==t.direction?a.go("districts.show.invoices.outgoing",t,{location:"replace"}):"incoming"==t.direction?a.go("districts.show.invoices.incoming",t,{location:"replace"}):a.go("districts.show.invoices.index",t,{location:"replace"})},l.print=function(){t.loadingState=!0;var a={direction:e.direction,current_page:e.current_page,per_page:e.per_page,search:e.search,payment_status:e.payment_status,orderby:e.orderby,paid_at_start:e.paid_at_start,paid_at_end:e.paid_at_end,created_at_start:e.created_at_start,created_at_end:e.created_at_end},i="?"+l.argsToUrl(a);n.print(e.districts_id,i).then(function(e){var a=new s([e.data],{type:"application/pdf"});a.size&&o.saveAs(a,"Fakturalista.pdf"),t.loadingState=!1})},l.openPaymentModal=function(t){var a=i.open({animation:!0,templateUrl:"DistrictInvoicePaymentModal.html",controller:"DistrictInvoicePaymentModalController as modalcontroller",size:"md",resolve:{invoice:function(){return t},districts_id:function(){return e.districts_id}}});a.result.then(function(){l.loadInvoices()})},l.download=function(t){n.download(e.districts_id,t.id).then(function(e){var a=new s([e.data],{type:"application/pdf"});a.size&&o.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})},l.loadInvoices()}]).controller("DistrictInvoiceController",["$rootScope","$stateParams","$state","DistrictInvoicesFactory","FileSaver","Blob",function(t,e,a,n,i,o){function s(){t.loadingState=!0,n.show(e.districts_id,e.id).then(function(n){n.data.invoice||a.go("districts.show.invoices.index",{districts_id:e.districts_id}),r.invoice=n.data.invoice,r.hideSignups=!0,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}var r=this;r.download=function(t){n.download(e.districts_id,t.id).then(function(e){var a=new o([e.data],{type:"application/pdf"});a.size&&i.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})},s()}]).controller("DistrictInvoicePaymentModalController",["$scope","$uibModalInstance","invoice","districts_id","DistrictInvoicesFactory",function(t,e,a,n,i){var o=this;o.options={showWeeks:!0,startingDay:1,maxDate:new Date},o.invoice=angular.copy(a),o.registerPayment=function(t){t.paid_at&&!o.loadingState&&(o.loadingState=!0,i.registerPayment(n,t.id,t.paid_at).then(function(t){e.close(t.data),o.loadingState=!1}))},o.cancel=function(){e.dismiss("cancel")}}]).factory("DistrictInvoicesFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){return t({method:"GET",url:e+"districts/"+a+"/invoices"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},print:function(a,n){return t({method:"GET",url:e+"districts/"+a+"/invoices/print"+n,responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},show:function(a,n){return t({method:"GET",url:e+"districts/"+a+"/invoices/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},registerPayment:function(a,n,i){return i=moment(new Date(i)).format("YYYY-MM-DD HH:mm:ss"),t({method:"PUT",url:e+"districts/"+a+"/invoices/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({paid_at:i})})},download:function(a,n){if(a&&n)return t({method:"GET",url:e+"districts/"+a+"/invoices/"+n+"/download",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.districts",[]).controller("DistrictsController",["$rootScope","$scope","$stateParams","$state","DistrictsFactory",function(t,e,a,n,i){var o=this;o.load=function(){t.loadingState=!0,i.load().then(function(e){o.districts=e.data.districts,t.loadingState=!1})},o.load()}]).controller("DistrictController",["$rootScope","$scope","$state","$stateParams","DistrictsFactory",function(t,e,a,n,i){function o(){t.loadingState=!0,i.find(n.districts_id).then(function(e){s.district=e.data.district,t.loadingState=!1})}var s=this;s.update=function(){var e=s.district;delete e.logo;var o=new FormData;for(var r in e)e.hasOwnProperty(r)&&o.append(r,e[r]);var l=document.getElementById("district-logo").files[0];l&&o.append("logo",l),i.update(s.district.id,o).then(function(){a.go("districts.show",{districts_id:n.districts_id},{location:"replace"})},function(e){t.displayFlashMessages(e.data,"error")})},o()}]).factory("DistrictsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(){var a=e+"districts";return t({method:"GET",url:a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"districts/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},update:function(a,n){return n.append("_method","PUT"),t({method:"POST",url:e+"districts/"+a,headers:{"Content-Type":void 0},data:n})}}}]),angular.module("app.errorhandler",[]).controller("ErrorHandlerController",["$rootScope","$scope","ErrorHandlerFactory",function(t,e,a){}]).factory("ErrorHandlerFactory",["$http","ApiEndpointUrl",function(t,e){return{reportError:function(a,n){return t({method:"POST",url:e+"error/report",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({error:a,cause:n})})}}}]),angular.module("app.invoices",[]).controller("GenerateInvoicesController",["$rootScope","$stateParams","$state","InvoicesFactory",function(t,e,a,n){function i(){t.loadingState=!0,n.loadPendingSignups().then(function(e){o.signups=e.data.signups,angular.forEach(o.signups,function(t){o.selectedSignups.push(t.id)}),o.hideSignups=!0,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}var o=this;o.selectedSignups=[],o.createInvoice=function(){return!!o.selectedSignups.length&&(t.loadingState=!0,void n.createInvoices(o.selectedSignups).then(function(e){t.displayFlashMessages(e.data.message,"success"),a.go("invoices.index"),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1}))},o.toggleInvoiceSignup=function(t){o.selectedSignups.indexOf(t.id)===-1?o.selectedSignups.push(t.id):o.selectedSignups.splice(o.selectedSignups.indexOf(t.id),1)},o.signupIsSelected=function(t){return o.selectedSignups.indexOf(t.id)>-1},i()}]).controller("InvoicesController",["$rootScope","$stateParams","$state","InvoicesFactory","$uibModal","FileSaver","Blob",function(t,e,a,n,i,o,s){function r(){t.loadingState=!0,n.load().then(function(e){l.invoices_incoming=e.data.invoices_incoming,l.invoices_outgoing=e.data.invoices_outgoing,l.invoices_generate=e.data.invoices_generate,l.hideSignups=!0,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}var l=this;l.openPaymentModal=function(t){var e=i.open({animation:!0,templateUrl:"InvoicePaymentModal.html",controller:"InvoicePaymentModalController as modalcontroller",size:"md",resolve:{invoice:function(){return t}}});e.result.then(function(){r()})},l.download=function(t){n.download(t.id).then(function(e){var a=new s([e.data],{type:"application/pdf"});a.size&&o.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})},r()}]).controller("InvoiceController",["$rootScope","$stateParams","$state","InvoicesFactory","FileSaver","Blob",function(t,e,a,n,i,o){function s(){t.loadingState=!0,n.load(e.id).then(function(e){e.data.invoice||a.go("invoices.index"),r.invoice=e.data.invoice,r.hideSignups=!0,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}var r=this;r.download=function(t){n.download(t.id).then(function(e){var a=new o([e.data],{type:"application/pdf"});a.size&&i.saveAs(a,"invoice-"+t.invoice_reference+".pdf")})},s()}]).controller("InvoicePaymentModalController",["$scope","$uibModalInstance","invoice","InvoicesFactory",function(t,e,a,n){var i=this;i.options={showWeeks:!0,startingDay:1,maxDate:new Date,minDate:moment(a.invoice_date).startOf("day")},i.invoice=angular.copy(a),i.registerPayment=function(t){t.paid_at&&!i.loadingState&&(i.loadingState=!0,n.registerPayment(t.id,t.paid_at).then(function(){e.close(),i.loadingState=!1}))},i.cancel=function(){e.dismiss("cancel")}}]).factory("InvoicesFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=a?"/"+a:"";return t({method:"GET",url:e+"invoices"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},loadPendingSignups:function(){return t({method:"GET",url:e+"invoices/pendingsignups",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createInvoices:function(a){return t({method:"POST",url:e+"invoices?signup_ids="+a.toString(),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"invoices/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},registerPayment:function(a,n){return n=moment(new Date(n)).format("YYYY-MM-DD HH:mm:ss"),t({method:"PUT",url:e+"invoices/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({paid_at:n})})},download:function(a){if(a)return t({method:"GET",url:e+"invoices/"+a+"/download",responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.premium",[]).controller("PremiumController",["$rootScope","$scope","$state","PremiumFactory",function(t,e,a,n){var i=this;i.loadPremium=function(){t.loadingState=!0,n.loadPremium().then(function(e){i.club=e.data,t.loadingState=!1})},i.registerPremium=function(){n.registerPremium().then(function(t){i.club=t.data},function(e){t.displayFlashMessages(e.data,"error")})},i.loadPremium()}]).factory("PremiumFactory",["$http","ApiEndpointUrl",function(t,e){return{loadPremium:function(){return t({method:"GET",url:e+"premium",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},registerPremium:function(){return t({method:"POST",url:e+"premium",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.public.competitions",[]).controller("PublicCompetitionsController",["$rootScope","$scope","$stateParams","$state","PublicCompetitionsFactory",function(t,e,a,n,i){function o(){t.loadingState=!0,i.load(a.id).then(function(e){s.competitions=e.data.competitions,t.loadingState=!1})}var s=this;o()}]).factory("PublicCompetitionsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a){var n=e+"public/competitions";return!angular.isUndefined(a)&&a>0&&(n+="/"+a),t({method:"GET",url:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"public/competitions/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.settings",[]).controller("SettingsController",["$rootScope","$scope","$state","SettingsFactory",function(t,e,a,n){var i=this;i.cancelaccount=function(){t.loadingState=!0,n.cancelaccount().then(function(e){t.displayFlashMessages(e.data.message),t.loadingState=!1,a.go("auth.logout")},function(e){t.displayFlashMessages(e.data.error),t.loadingState=!1})}}]).controller("PasswordController",["$rootScope","$scope","$state","SettingsFactory",function(t,e,a,n){var i=this;i.reset={current_password:"",password:"",password_confirmation:""},i.updatePassword=function(){n.updatePassword(i.reset).then(function(e){i.reset={current_password:"",password:"",password_confirmation:""},t.displayFlashMessages(e.data)},function(e){t.displayFlashMessages(e.data,"error")})}}]).controller("UserProfileController",["$rootScope","$scope","$state","SettingsFactory",function(t,e,a,n){function i(){t.loadingState=!0,n.loadUserprofile().then(function(e){o.userprofile=e.data.user,t.loadingState=!1})}var o=this;o.datePickerOptions={startingDay:1,start:{opened:!1},end:{opened:!1}},o.saveUserprofile=function(){t.loadingState=!0,n.saveUserprofile(o.userprofile).then(function(e){localStorage.setItem("user",JSON.stringify(e.data.user)),o.userprofile=e.data.user,t.loadingState=!1,a.go("settings.user")},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},o.cancelUserprofile=function(){i(),a.go("settings.user")},i()}]).controller("InviteController",["$rootScope","$scope","$state","InviteFactory",function(t,e,a,n){var i=this;i.loadInvites=function(){n.loadInvites().then(function(t){i.invites=t.data.invites})},i.loadInvites(),i.invite=function(){t.loadingState=!0,n.invite(i.user).then(function(e){i.user={name:"",lastname:"",email:""},i.loadInvites(),t.displayFlashMessages(e.data.message),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}}]).factory("InviteFactory",["$http","ApiEndpointUrl",function(t,e){return{loadInvites:function(){return t({method:"GET",url:e+"users/invite",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},invite:function(a){return t({method:"POST",url:e+"users/invite",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})}}}]).factory("SettingsFactory",["$http","ApiEndpointUrl",function(t,e){return{loadUserprofile:function(){return t({method:"GET",url:e+"authenticate/user",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},saveUserprofile:function(a){var n=angular.copy(a);return n.birthday=n.birthday+"-01-01",t({method:"PUT",url:e+"authenticate/user",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},updatePassword:function(a){return t({method:"PUT",url:e+"authenticate/updatePassword",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})},cancelaccount:function(){return t({method:"POST",url:e+"authenticate/cancelAccount",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.signups",[]).controller("SignupsController",["$rootScope","$scope","$stateParams","$state","SignupsFactory",function(t,e,a,n,i){function o(e){t.loadingState=!0,i.load(e).then(function(e){r.signups=e.data.signups,r.invoices_generate=e.data.invoices_generate,t.loadingState=!1})}function s(){}var r=this;this.page=parseInt(a.page,10),this.sort=a.sort,this.sortOptions=["upvotes","date","author"],s(),o()}]).controller("SignupController",["$rootScope","$scope","$stateParams","$state","$timeout","SignupsFactory",function(t,e,a,n,i,o){function s(){t.loadingState=!0,o.find(a.id).then(function(e){r.signups=e.data.signups,r.user=JSON.parse(localStorage.getItem("user")),t.loadingState=!1},function(){t.loadingState=!1,n.go("signups",{},{location:"replace"})})}var r=this;r.updateSignup=function(e){r.state="updating",o.updateSignup(e).then(function(a){t.displayFlashMessages(a.data.message),a.data.signups.participate_out_of_competition=parseInt(a.data.signups.participate_out_of_competition),a.data.signups.weaponclasses_id=parseInt(a.data.signups.weaponclasses_id),r.signups.signups=a.data.signups,r.state="updated",n.go("signup",{id:e.id})},function(e){t.displayFlashMessages(e.data.message,"error")})},r.deleteSignup=function(t){o.deleteSignup(t).then(function(){n.go("signups")})},s()}]).controller("ClubSignupController",["$rootScope","$scope","$stateParams","$state","$timeout","SignupsFactory",function(t,e,a,n,i,o){function s(){t.loadingState=!0,o.loadClubSignups(a.id).then(function(e){r.competition=e.data.competition,r.club=e.data.club,t.loadingState=!1},function(e){t.displayFlashMessages(e.data.message,"error"),t.loadingState=!1})}var r=this;r.createSignup=function(e,n){if(r.loadingState)return!1;r.loadingState=!0;var i={competitions_id:a.id,weaponclasses_id:n,users_id:e};o.createSignup(i).then(function(t){t.data.weaponclasses_id=parseInt(t.data.weaponclasses_id),r.competition.signups.push(t.data),r.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),r.loadingState=!1})},r.deleteSignup=function(e){return!r.loadingState&&(r.loadingState=!0,void o.deleteSignup(e).then(function(){angular.forEach(r.competition.signups,function(t,a){t.id==e.id&&r.competition.signups.splice(a,1)}),r.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),r.loadingState=!1}))},s()}]).factory("SignupsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){var i=e+"signup";return!angular.isUndefined(n)&&n>0&&(i+="/"+n),a&&(i+="?page="+a),t({method:"GET",url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"signup/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createSignup:function(a){return t({method:"POST",url:e+"signup",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})},updateSignup:function(a){return t({method:"PUT",url:e+"signup/"+a.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(a)})},deleteSignup:function(a){return t({method:"DELETE",url:e+"signup/"+a.id,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},loadClubSignups:function(a){return t({method:"GET",url:e+"competitions/"+a+"/clubsignups",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.teams",[]).controller("TeamSignupController",["$rootScope","$scope","$stateParams","$state","CompetitionsFactory","TeamsFactory",function(t,e,a,n,i,o){function s(){t.loadingState=!0,a.teams_id?o.load(a.id,a.teams_id).then(function(e){r.teams=e.data.teams,r.signups_ordinary_available=e.data.signups_ordinary_available,r.signups_reserve_available=e.data.signups_reserve_available,angular.forEach(r.teams.signups,function(t,e){1==t.pivot.position&&(r.teams.teams_signups_first=t.id),2==t.pivot.position&&(r.teams.teams_signups_second=t.id),3==t.pivot.position&&(r.teams.teams_signups_third=t.id),4==t.pivot.position&&(r.teams.teams_signups_fourth=t.id),5==t.pivot.position&&(r.teams.teams_signups_fifth=t.id)}),r.teams.signups=null,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1}):o.load(a.id,a.teams_id).then(function(e){r.addTeam={name:"",weapongroups_id:"",teams_signups_first:null,teams_signups_second:null,teams_signups_third:null,teams_signups_fourth:null,teams_signups_fifth:null},r.teams=e.data.teams,r.signups_ordinary_available=e.data.signups_ordinary_available,r.signups_reserve_available=e.data.signups_reserve_available,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})}var r=this;r.createTeam=function(){r.addTeam.name&&r.addTeam.weapongroups_id&&o.store(a.id,r.addTeam).then(function(e){t.displayFlashMessages(e.data.message),n.go("competition.teamsignups",{id:a.id},{reload:!0})},function(e){t.displayFlashMessages(e.data.message,"error"),e.data.redirect_to_edit&&n.go("competition.teamsignups.edit",{id:a.id,teams_id:e.data.redirect_to_edit},{reload:!0})})},r.updateTeam=function(e){r.teams.name&&r.teams.weapongroups_id&&o.update(a.id,r.teams.id,e).then(function(e){t.displayFlashMessages(e.data.message),n.go("competition.teamsignups",{id:a.id},{reload:!0})},function(e){t.displayFlashMessages(e.data.message,"error"),e.data.redirect_to_edit&&n.go("competition.teamsignups.edit",{id:a.id,teams_id:e.data.redirect_to_edit},{reload:!0})})},r.cancelTeam=function(){n.go("competition.teamsignups",{id:a.id},{reload:!0})},r.deleteTeam=function(e){e&&o["delete"](a.id,e).then(function(e){t.displayFlashMessages(e.data),n.go("competition.teamsignups",{id:a.id},{reload:!0})},function(e){t.displayFlashMessages(e.data.message,"error")})},s()}]).factory("TeamsFactory",["$http","ApiEndpointUrl",function(t,e){return{load:function(a,n){return a&&n?url=e+"competitions/"+a+"/teamsignups/"+n:url=e+"competitions/"+a+"/teamsignups",t({method:"GET",url:url,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},find:function(a){return t({method:"GET",url:e+"competitions/"+competitions_id+"/teamsignups",headers:{"Content-Type":"application/x-www-form-urlencoded"}})},store:function(a,n){return t({method:"POST",url:e+"competitions/"+a+"/teamsignups",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},update:function(a,n,i){return t({method:"PUT",url:e+"competitions/"+a+"/teamsignups/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(i)})},"delete":function(a,n){return t({method:"DELETE",url:e+"competitions/"+a+"/teamsignups/"+n,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),angular.module("app.users",[]).controller("UserController",["$rootScope","$stateParams","$state","UsersFactory",function(t,e,a,n){function i(){t.loadingState=!0,e.user_id?n.find(e.user_id).then(function(e){o.user=e.data,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),o.user="",t.loadingState=!1}):(o.user={},t.loadingState=!1)}var o=this;i(),o.saveUser=function(e){n.saveUser(e).then(function(e){t.displayFlashMessages(e.data),a.go("club.users.index",{},{location:"reload"})},function(e){t.displayFlashMessages(e.data,"error")})},o.createUser=function(e){return!o.loadingState&&(o.loadingState=!0,void n.createUser(e).then(function(e){t.displayFlashMessages(e.data),a.go("club.users.index",{},{location:"reload"}),o.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),o.loadingState=!1}))}}]).controller("UserChangeClubController",["$rootScope","$scope","$stateParams","$state","ClubsFactory","UsersFactory",function(t,e,a,n,i,o){function s(){t.loadingState=!0,a.user_id?o.find(a.user_id).then(function(e){r.user=e.data,r.user.clubs.length&&(r.currentClub=r.user.clubs[0]),t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),r.user="",t.loadingState=!1}):(r.user={},t.loadingState=!1)}var r=this;r.searchQuery="",r.selectedclub={},r.new_club=null,r.add_clubs_nr="",r.currentClub=null,s(),r.searchForClubs=function(e,a){return i.searchForClubs(e).then(function(t){return r.foundMatch=t.data.clubs.length>0,t.data.clubs.map(function(t){return t.alreadySelected=!1,r.currentClub.id==t.id&&(t.alreadySelected=!0),t})},function(e){t.displayFlashMessages(e.data,"warning")})},r.selectClub=function(t){return t.alreadySelected!==!0&&(r.noMatchingClubs=null,void(r.new_club=t))},r.noClubsFound=function(){r.noMatchingClubs=!0,r.new_club=null},r.changeClub=function(e){t.loadingState=!0,o.changeClub(a.user_id,e.id).then(function(e){r.new_club=null,t.displayFlashMessages(e.data.message,"success"),t.loadingState=!1})}}]).controller("UserClubChangesController",["$rootScope","$scope","$stateParams","$state","ClubsFactory","UsersFactory",function(t,e,a,n,i,o){var s=this;s.loadClubChanges=function(){t.loadingState=!0,i.loadClubChanges().then(function(e){s.clubChanges=e.data,t.loadingState=!1},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},s.approveClubChange=function(e){t.loadingState=!0,i.approveClubChange(e).then(function(a){t.loadingState=!1,t.displayFlashMessages(a.data,"message"),s.clubChanges.splice(s.clubChanges.indexOf(e),1)},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},s.cancelClubChange=function(e){t.loadingState=!0,i.cancelClubChange(e).then(function(a){t.loadingState=!1,t.displayFlashMessages(a.data,"message"),s.clubChanges.splice(s.clubChanges.indexOf(e),1)},function(e){t.displayFlashMessages(e.data,"error"),t.loadingState=!1})},s.loadClubChanges()}]).factory("UsersFactory",["$http","ApiEndpointUrl",function(t,e){return{find:function(a){return t({method:"GET",url:e+"users/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},createUser:function(a){var n=angular.copy(a);return n.birthday=n.birthday+"-01-01",t({method:"POST",url:e+"users",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},saveUser:function(a){var n=angular.copy(a);return n.birthday=n.birthday+"-01-01",t({method:"PUT",url:e+"users/"+n.user_id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(n)})},changeClub:function(a,n){return t({method:"POST",url:e+"users/"+a+"/clubChanges",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param({to_clubs_id:n})})}}}]),app.config(["$provide",function(t){t.decorator("$exceptionHandler",["$delegate","$injector",function(t,e){return function(e,a){Raven.captureException(e),t(e,a)}}])}]),app.config(["$httpProvider",function(t){t.interceptors.push(["$q","$injector","$rootScope","xcsrftoken",function(t,e,a,n){return{request:function(t){var e=localStorage.getItem("token");return null!==e&&(t.headers.Authorization="Bearer "+e),t.headers["X-Requested-With"]="XMLHttpRequest",t},responseError:function(n){var i,o=e.get("AuthFactory"),s=e.get("$state");if("undefined"!=typeof n.data.error?i=n.data.error:"undefined"!=typeof n.data?i=n.data:"undefined"!=typeof n.error&&(i=n.error),"token_expired"==i)return o.attemptRefreshToken(n.config);if("user_inactive"==i||"user_not_found"==i||"token_invalid"==i||"token_absent"==i||"unauthenticated"==i)localStorage.removeItem("user"),localStorage.removeItem("token"),a.authenticated=!1,a.currentUser=null,s.go("auth.login",{},{location:"replace"});else{if("user_is_not_admin"==i)return a.displayFlashMessages(n.data.message,"error"),s.go("dashboard");if("api_version_update"==i)return a.displayFlashMessages(n.message,"error"),location.reload(!0)}return t.reject(n)}}}])}]),angular.module("ui.calendar",[]).constant("uiCalendarConfig",{}).controller("uiCalendarCtrl",["$scope","$timeout","$locale",function(t,e,a){var n=1,i=1,o=t.eventSources,s=t.calendarWatchEvent?t.calendarWatchEvent:angular.noop,r=function(t){var a;return t&&(a=function(){var a=arguments,n=this;e(function(){t.apply(n,a)})}),a};this.eventsFingerprint=function(t){return t._id||(t._id=i++),""+t._id+(t.id||"")+(t.title||"")+(t.url||"")+(+t.start||"")+(+t.end||"")+(t.allDay||"")+(t.className||"")+s(t)||""},this.sourcesFingerprint=function(t){return t.__id||(t.__id=n++)},this.allEvents=function(){for(var t=[],e=0,a=o.length;e<a;e++){var n=o[e];if(angular.isArray(n))t.push(n);else if(angular.isObject(n)&&angular.isArray(n.events)){var i={};for(var s in n)"_uiCalId"!==s&&"events"!==s&&(i[s]=n[s]);for(var r=0;r<n.events.length;r++)angular.extend(n.events[r],i);t.push(n.events)}}return Array.prototype.concat.apply([],t)},this.changeWatcher=function(t,e){var a,n=function(){for(var a,n,i=angular.isFunction(t)?t():t,s=[],r=0,l=i.length;r<l;r++)n=i[r],a=e(n),o[a]=n,s.push(a);return s},i=function(t,e){var a,n,i=[],o={};for(a=0,n=e.length;a<n;a++)o[e[a]]=!0;for(a=0,n=t.length;a<n;a++)o[t[a]]||i.push(t[a]);return i},o={},s=function(t,n){var s,r,l,c,d={},p=i(n,t);for(s=0,r=p.length;s<r;s++){var u=p[s];l=o[u],delete o[u];var m=e(l);m===u?a.onRemoved(l):(d[m]=u,a.onChanged(l))}var g=i(t,n);for(s=0,r=g.length;s<r;s++)c=g[s],l=o[c],d[c]||a.onAdded(l)};return a={subscribe:function(t,e){t.$watch(n,function(t,a){e&&e(t,a)===!1||s(t,a)},!0)},onAdded:angular.noop,onChanged:angular.noop,onRemoved:angular.noop}},this.getFullCalendarConfig=function(t,e){var a={};return angular.extend(a,e),angular.extend(a,t),angular.forEach(a,function(t,e){"function"==typeof t&&(a[e]=r(a[e]))}),a},this.getLocaleConfig=function(t){if(!t.lang||t.useNgLocale){var e=function(t){var e,a;e=[];for(a in t)e[a]=t[a];return e},n=a.DATETIME_FORMATS;return{monthNames:e(n.MONTH),monthNamesShort:e(n.SHORTMONTH),dayNames:e(n.DAY),dayNamesShort:e(n.SHORTDAY)}}return{}}}]).directive("uiCalendar",["uiCalendarConfig",function(t){return{restrict:"A",scope:{eventSources:"=ngModel",calendarWatchEvent:"&"},controller:"uiCalendarCtrl",link:function(e,a,n,i){function o(){var a,o=n.uiCalendar?e.$parent.$eval(n.uiCalendar):{};a=i.getFullCalendarConfig(o,t);var r=i.getLocaleConfig(a);angular.extend(r,a),d={eventSources:s},angular.extend(d,r);var l={};for(var c in d)"eventSources"!==c&&(l[c]=d[c]);return JSON.stringify(l)}var s=e.eventSources,r=!1,l=i.changeWatcher(s,i.sourcesFingerprint),c=i.changeWatcher(i.allEvents,i.eventsFingerprint),d=null;e.destroy=function(){e.calendar&&e.calendar.fullCalendar&&e.calendar.fullCalendar("destroy"),n.calendar?e.calendar=e.$parent[n.calendar]=$(a).html(""):e.calendar=$(a).html("")},e.init=function(){e.calendar.fullCalendar(d)},l.onAdded=function(t){e.calendar.fullCalendar("addEventSource",t),r=!0},l.onRemoved=function(t){e.calendar.fullCalendar("removeEventSource",t),r=!0},c.onAdded=function(t){e.calendar.fullCalendar("renderEvent",t)},c.onRemoved=function(t){e.calendar.fullCalendar("removeEvents",function(e){return e._id===t._id})},c.onChanged=function(t){t._start=$.fullCalendar.moment(t.start),t._end=$.fullCalendar.moment(t.end),e.calendar.fullCalendar("updateEvent",t)},l.subscribe(e),c.subscribe(e,function(t,e){if(r===!0)return r=!1,!1}),e.$watch(o,function(t,a){e.destroy(),e.init()})}}}]),app.directive("ngEnter",function(){return function(t,e,a){e.bind("keydown keypress",function(e){e.altKey||e.shiftKey||e.ctrlKey||13!==e.which||(t.$apply(function(){t.$eval(a.ngEnter,{event:e})}),e.preventDefault())})}}),app.directive("ngInfiniteScroll",["$window",function(t){return function(e,a,n){angular.element(t).bind("scroll",function(){var t="innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight,a=document.body,n=document.documentElement,i=Math.max(a.scrollHeight,a.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight);windowBottom=t+window.pageYOffset,windowBottom>=i&&(e.offset=e.offset+e.limit,e.load())})}}]),app.directive("stringToNumber",function(){return{require:"ngModel",link:function(t,e,a,n){n.$parsers.push(function(t){return""+t}),n.$formatters.push(function(t){return parseFloat(t,10)})}}}),app.filter("cutString",function(){return function(t,e,a,n){if(!t)return"";if(a=parseInt(a,10),!a)return t;if(t.length<=a)return t;if(t=t.substr(0,a),e){var i=t.lastIndexOf(" ");i!=-1&&(t=t.substr(0,i))}return t+(n||"…")}}),app.filter("dateToISO",function(){return function(t){if(void 0!==t&&null!==t){var e=t.split(/[^0-9]/),a=new Date(e[0],e[1]-1,e[2],e[3],e[4],e[5]);return new Date(a).toISOString()}}}),app.filter("excludeByIds",function(){return function(t,e){var a=[];return angular.forEach(t,function(t){
e.indexOf(t.id)==-1&&a.push(t)}),a}}),app.filter("filterByWeapongroupsId",function(){return function(t,e,a){var n=[];return angular.forEach(t,function(t){!a&&3==e||17==e?t.weaponclass.weapongroups_id!=e&&4!=t.weaponclass.weapongroups_id&&5!=t.weaponclass.weapongroups_id&&6!=t.weaponclass.weapongroups_id||n.push(t):t.weaponclass.weapongroups_id==e&&n.push(t)}),n}}),app.filter("isEmpty",[function(){return function(t){return angular.equals({},t)}}]),app.filter("num",function(){return function(t){return parseInt(t,10)}}),app.filter("padZero",function(){return function(t,e){t=t.toString();var a="",n=null;if(void 0===t&&(t=""),t.length>=e)n=t;else{for(var i=t.length;i<e;i++)a+="0";n=(a+t).slice(-1*e)}return n}}),app.filter("range",function(){return function(t,e,a){e=parseInt(e),a=parseInt(a);var n;if(e<a)for(n=e;n<a;n++)t.push(n);else for(n=e;n>a;n--)t.push(n);return t}}),app.filter("renderHTMLCorrectly",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]),app.filter("sumByKey",function(){return function(t,e){if("undefined"==typeof t||"undefined"==typeof e)return 0;for(var a=0,n=t.length-1;n>=0;n--)a+=parseInt(t[n][e]);return a}}),app.filter("sumTotalLength",function(){return function(t,e){if("undefined"==typeof t||"undefined"==typeof e)return 0;var a=0;return angular.forEach(t,function(t,n){t[e].length&&(a+=parseInt(t[e].length))}),a}}),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("admin.clubs",{"abstract":!0,url:"/clubs",restricted:!0}),t.state("admin.clubs.index",{url:"?current_page&per_page&search&hide_without_admins&hide_without_users&hide_deleted",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.clubs.index",controller:"AdminClubsController as clubs"}},params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},hide_without_admins:{value:"1",squash:!0},hide_without_users:{value:"1",squash:!0},hide_deleted:{value:"1",squash:!0}}}),t.state("admin.clubs.show",{url:"/:id",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.clubs.show",controller:"AdminClubController as clubs"}}}),t.state("admin.clubs.show.edit",{url:"/edit",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.clubs.edit"}}}),t.state("admin.clubs.show.users",{url:"/users",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.clubs.users"}}}),t.state("admin.clubs.show.admins",{url:"/admins",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.clubs.admins"}}}),t.state("admin.clubs.show.invoices",{url:"/invoices",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.clubs.invoices.index"}}}),t.state("admin.clubs.show.signups",{url:"/signups",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.clubs.signups"}}}),t.state("admin.clubs.show.teams",{url:"/teams",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.clubs.teams"}}}),t.state("admin.clubs.show.invoices.incoming",{url:"/incoming",restricted:!0,views:{"main@admin.clubs.show":{templateUrl:"/views/partials.admin.clubs.invoices.incoming"}}}),t.state("admin.clubs.show.invoices.outgoing",{url:"/outgoing",restricted:!0,views:{"main@admin.clubs.show":{templateUrl:"/views/partials.admin.clubs.invoices.outgoing"}}}),t.state("admin.clubs.show.merge",{url:"/merge",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.clubs.merge"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("admin.districts",{"abstract":!0,url:"/districts",restricted:!0}),t.state("admin.districts.index",{url:"?current_page&per_page&search",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.districts.index",controller:"AdminDistrictsController as districts"}},params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0}}}),t.state("admin.districts.show",{url:"/:id",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.districts.show",controller:"AdminDistrictController as districts"}}}),t.state("admin.districts.show.clubs",{url:"/clubs",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.districts.clubs"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("admin.invoices",{"abstract":!0,url:"/invoices",restricted:!0}),t.state("admin.invoices.index",{url:"?current_page&per_page&search&payment_status",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.invoices.index",controller:"AdminInvoicesController as invoices"}},params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},payment_status:{value:"all",squash:!0}}}),t.state("admin.invoices.show",{url:"/:id",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.invoices.show",controller:"AdminInvoiceController as invoices"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("admin",{url:"/admin",parent:"root","abstract":!0,restricted:!0}),t.state("admin.dashboard",{url:"/dashboard",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.dashboard",controller:"AdminDashboardController as dashboard"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("admin.signups",{"abstract":!0,url:"/signups",restricted:!0}),t.state("admin.signups.index",{url:"?current_page&per_page&search%competitions_id",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.signups.index",controller:"AdminSignupsController as signups"}},params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},competitions_id:{value:null,squash:!0}}}),t.state("admin.signups.show",{url:"/:signup_id",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.signups.show",controller:"AdminSignupController as signup"}}}),t.state("admin.signups.show.edit",{url:"/edit",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.signups.edit"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("admin.users",{"abstract":!0,url:"/users",restricted:!0}),t.state("admin.users.index",{url:"?current_page&per_page&search&status",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.users.index",controller:"AdminUsersController as users"}},params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},status:{value:"all",squash:!0}}}),t.state("admin.users.import",{url:"/import",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.users.import",controller:"AdminUserImportController as user"}}}),t.state("admin.users.clubChanges",{url:"/clubChanges",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.users.clubChanges",controller:"AdminUserClubChangesController as user"}}}),t.state("admin.users.show.edit",{url:"/edit",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.users.edit"}}}),t.state("admin.users.show.signups",{url:"/signups",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.users.signups"}}}),t.state("admin.users.show.invoices",{url:"/invoices",restricted:!0,views:{main:{templateUrl:"/views/partials.admin.users.invoices"}}}),t.state("admin.users.show",{url:"/:user_id",restricted:!0,views:{"content@":{templateUrl:"/views/partials.admin.users.show",controller:"AdminUserController as user"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("auth",{url:"/auth",parent:"public","abstract":!0,views:{"content@":{templateUrl:"/publicviews/index",controller:"AuthController"}}}),a.when("/auth","/auth/login"),t.state("auth.register",{url:"/register",templateUrl:"/publicviews/register"}),t.state("auth.invite",{url:"/register/:invite_token",templateUrl:"/publicviews/register",controller:"AuthController"}),t.state("auth.inactive",{url:"/inactive",templateUrl:"/publicviews/inactive"}),t.state("auth.activate",{url:"/activate/:token",templateUrl:"/publicviews/activate",controller:"ActivationController"}),t.state("auth.login",{url:"/login",templateUrl:"/publicviews/login"}),t.state("auth.password",{url:"/password",templateUrl:"/publicviews/password"}),t.state("auth.reset",{url:"/reset/:token",templateUrl:"/publicviews/reset",controller:["$rootScope","$scope","$stateParams","AuthFactory",function(t,e,a,n){e.reset={email:"",token:a.token},e.resetPassword=function(){n.resetPassword(e.reset).then(function(t){e.passwordRequested=!0,e.reset={email:"",token:a.token},"success"!==t.data.status&&(e.passwordRequested=!0)},function(a){t.displayFlashMessages(a.data,"error"),e.passwordRequested=!1})}}]}),t.state("auth.logout",{url:"/logout",controller:["AuthFactory",function(t){t.logout()}],restricted:!0})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("championships",{parent:"root","abstract":!0,url:"/championships",restricted:!0,views:{"content@":{templateUrl:"/views/partials.championships.index"}}}),t.state("championships.index",{url:"?current_page&per_page&search",parent:"championships",views:{"content@":{templateUrl:"/views/partials.championships.index",controller:"ChampionshipsController",controllerAs:"championships"}},restricted:!0,params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0}}}),t.state("championships.show",{url:"/:championships_id",restricted:!0,views:{"content@":{templateUrl:"/views/partials.championships.show",controller:"ChampionshipController as championships"}}}),t.state("championships.show.competitions",{url:"/competitions",restricted:!0,views:{"main@championships.show":{templateUrl:"/views/partials.championships.show.competitions"}}}),t.state("championships.show.signups",{url:"/signups?current_page&per_page&search%competitions_id",restricted:!0,views:{"main@championships.show":{templateUrl:"/views/partials.championships.show.signups",controller:"ChampionshipSignupsController as signups"}},params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},competitions_id:{value:null,squash:!0}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("club.invoices",{"abstract":!0,url:"/invoices",restricted:!0}),t.state("club.invoices.index",{url:"",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.invoices.index",controller:"ClubInvoicesController as invoices"}}}),t.state("club.invoices.incoming",{url:"/incoming?current_page&per_page&search&payment_status&direction",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.invoices.incoming",controller:"ClubInvoicesController as invoices"}},params:{direction:{value:"incoming",squash:!0},current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},payment_status:{value:"all",squash:!0},paid_at_start:{vaue:"",squash:!0},paid_at_end:{vaue:"",squash:!0},created_at_start:{vaue:"",squash:!0},created_at_end:{vaue:"",squash:!0}}}),t.state("club.invoices.outgoing",{url:"/outgoing?current_page&per_page&search&payment_status&direction&paid_at_start&paid_at_end&created_at_start&created_at_end",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.invoices.outgoing",controller:"ClubInvoicesController as invoices"}},params:{direction:{value:"outgoing",squash:!0},current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},payment_status:{value:"all",squash:!0},paid_at_start:{value:"",squash:!0},paid_at_end:{value:"",squash:!0},created_at_start:{value:"",squash:!0},created_at_end:{value:"",squash:!0}}}),t.state("club.invoices.generate",{url:"/generate",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.invoices.generate",controller:"ClubGenerateInvoicesController as invoices"}}}),t.state("club.invoices.show",{url:"/:id",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.invoices.show",controller:"ClubInvoiceController as invoices"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("club",{url:"/club",parent:"root","abstract":!0,restricted:!0,views:{"content@":{templateUrl:"/views/partials.club.index",controller:"ClubController as club"}}}),t.state("club.connect",{url:"/club/connect",parent:"root",views:{"content@":{templateUrl:"/views/partials.club.connect",controller:"ClubConnectController as club"}}}),t.state("club.information",{url:"/information",views:{main:{templateUrl:"/views/partials.club.information",controller:"ClubController as club"}},restricted:!0}),t.state("club.edit",{url:"/edit",views:{main:{templateUrl:"/views/partials.club.edit",controller:"ClubController as club"}},restricted:!0}),t.state("club.competitions",{url:"/competitions?current_page&per_page&search&status&type&usersignup&clubs_id",views:{main:{templateUrl:"/views/partials.club.competitions",controller:"ClubCompetitionsController",controllerAs:"competitions"}},params:{clubs_id:{value:"true",squash:"true"},current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},status:{value:"all",squash:!0},type:{value:"0",squash:!0},usersignup:{value:"",squash:!0}},restricted:!0}),t.state("club.championships",{url:"/championships?current_page&per_page&search&clubs_id",views:{main:{templateUrl:"/views/partials.club.championships",controller:"ClubChampionshipsController",controllerAs:"championships"}},params:{clubs_id:{value:"true",squash:"true"},current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0}},restricted:!0}),t.state("club.admins",{url:"/admins",views:{main:{templateUrl:"/views/partials.club.admins"}},restricted:!0}),t.state("club.change",{url:"/change",views:{main:{templateUrl:"/views/partials.club.change",controller:"ClubChangeController as club"}},restricted:!0}),t.state("club.premium",{url:"/premium",views:{main:{templateUrl:"/views/partials.premium.index",controller:"PremiumController as premium"}}}),t.state("club.users",{"abstract":!0,url:"/users",restricted:!0}),t.state("club.users.index",{url:"",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.users.index",controller:"ClubController as club"}}}),t.state("club.users.edit",{url:"/:user_id/edit",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.users.edit",controller:"UserController as user"}}}),t.state("club.users.changeClub",{url:"/:user_id/changeClub",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.users.changeClub",controller:"UserChangeClubController as user"}}}),t.state("club.users.create",{url:"/create",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.users.create",controller:"UserController as user"}}}),t.state("club.users.clubChanges",{url:"/clubChanges",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.users.clubChanges",controller:"UserClubChangesController as user"}}}),t.state("club.users.show",{url:"/:user_id",restricted:!0,views:{"main@club":{templateUrl:"/views/partials.club.users.show",controller:"UserController as user"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("competitions.admin.edit",{url:"/edit",restricted:!0,"abstract":!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.edit",controller:function(){}}}}),t.state("competitions.admin.edit.status",{url:"/status",restricted:!0,views:{"edit@competitions.admin.edit":{templateUrl:"/views/partials.competitions.admin.edit.status"}}}),t.state("competitions.admin.edit.information",{url:"/information",restricted:!0,views:{"edit@competitions.admin.edit":{templateUrl:"/views/partials.competitions.admin.edit.information"}}}),t.state("competitions.admin.edit.date",{url:"/date",restricted:!0,views:{"edit@competitions.admin.edit":{templateUrl:"/views/partials.competitions.admin.edit.date"}}}),t.state("competitions.admin.edit.signup",{url:"/signup",restricted:!0,views:{"edit@competitions.admin.edit":{templateUrl:"/views/partials.competitions.admin.edit.signup"}}}),t.state("competitions.admin.edit.contact",{url:"/contact",restricted:!0,views:{"edit@competitions.admin.edit":{templateUrl:"/views/partials.competitions.admin.edit.contact"}}}),t.state("competitions.admin.edit.weaponclasses",{url:"/weaponclasses",restricted:!0,views:{"edit@competitions.admin.edit":{templateUrl:"/views/partials.competitions.admin.edit.weaponclasses",controller:"CompetitionsAdminWeaponclassesController",controllerAs:"weaponclasses"}}}),t.state("competitions.admin.edit.admins",{url:"/admins",restricted:!0,views:{"edit@competitions.admin.edit":{templateUrl:"/views/partials.competitions.admin.edit.admins",controller:"CompetitionsAdminAdminsController",controllerAs:"admins"}}}),t.state("competitions.admin.edit.stations",{url:"/stations",restricted:!0,views:{"edit@competitions.admin.edit":{templateUrl:"/views/partials.competitions.admin.edit.stations",controller:"CompetitionsAdminStationsController",controllerAs:"stations"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("competitions.admin.export",{url:"/export",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.export",controller:"CompetitionsAdminExportController",controllerAs:"export"}}}),t.state("competitions.admin.export.signups",{url:"/signups",restricted:!0,views:{"export@competitions.admin.export":{templateUrl:"/views/partials.competitions.admin.export.signups"}}}),t.state("competitions.admin.export.signups.xlsx",{url:"/xlsx",restricted:!0,views:{"export@competitions.admin.export":{templateUrl:"/views/partials.competitions.admin.export.signups-xlsx"}}}),t.state("competitions.admin.export.teams",{url:"/teams",restricted:!0,views:{"export@competitions.admin.export":{templateUrl:"/views/partials.competitions.admin.export.teams"}}}),t.state("competitions.admin.export.patrols",{url:"/patrols",restricted:!0,views:{"export@competitions.admin.export":{templateUrl:"/views/partials.competitions.admin.export.patrols"}}}),t.state("competitions.admin.export.shootingcards",{url:"/shootingcards",restricted:!0,views:{"export@competitions.admin.export":{templateUrl:"/views/partials.competitions.admin.export.shootingcards"}}}),t.state("competitions.admin.export.results",{url:"/results",restricted:!0,views:{"export@competitions.admin.export":{templateUrl:"/views/partials.competitions.admin.export.results"}}})}]),app.config(["$stateProvider",function(t){t.state("competitions.admin.invoices",{url:"/invoices","abstract":!0}),t.state("competitions.admin.invoices.show",{url:"/:id",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.invoices.show",controller:"CompetitionsAdminInvoiceController as invoices"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("competitions.admin.patrols",{url:"/patrols","abstract":!0,restricted:!0}),t.state("competitions.admin.patrols.index",{url:"",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.patrols"},"patrols@competitions.admin.patrols.index":{templateUrl:"/views/partials.competitions.admin.patrols.patrols",controller:"CompetitionsAdminPatrolsController",controllerAs:"patrols"}},params:{patrol_type:{value:"",squash:!0}}}),t.state("competitions.admin.patrols.edit",{url:"/edit",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.patrols.edit",controller:"CompetitionsAdminPatrolsEditController",controllerAs:"patrols"}}}),t.state("competitions.admin.patrols.finals",{url:"/finals",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.patrols"},"patrols@competitions.admin.patrols.finals":{templateUrl:"/views/partials.competitions.admin.patrols.finals",controller:"CompetitionsAdminPatrolsController",controllerAs:"patrols"}},params:{patrol_type:{value:"finals",squash:!0}}}),t.state("competitions.admin.patrols.distinguish",{url:"/distinguish",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.patrols"},"patrols@competitions.admin.patrols.distinguish":{templateUrl:"/views/partials.competitions.admin.patrols.distinguish",controller:"CompetitionsAdminPatrolsController",controllerAs:"patrols"}},params:{patrol_type:{value:"distinguish",squash:!0}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("competitions.admin.results",{url:"/results","abstract":!0,restricted:!0}),t.state("competitions.admin.results.index",{url:"",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.results"}}}),t.state("competitions.admin.results.prices",{url:"/prices",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.results.prices",controller:"CompetitionsAdminResultsPricesController as prices"}}}),t.state("competitions.admin.results.registration",{url:"/registration?patrol&patrol_type&station_start&station_end&lane_start&lane_end&show_empty_lanes&per_shot",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.results.filter_default",controller:"CompetitionsAdminResultsRegistrationController as results"},"field@competitions.admin.results.registration":{templateUrl:"/views/partials.competitions.admin.results.field"},"military@competitions.admin.results.registration":{templateUrl:"/views/partials.competitions.admin.results.military"},"precision@competitions.admin.results.registration":{templateUrl:"/views/partials.competitions.admin.results.precision"}},params:{patrol:{value:"1",squash:!0},patrol_type:{value:"",squash:!0},station_start:{value:"1",squash:!0},station_end:{value:"1",squash:!0},lane_start:{value:"1",squash:!0},lane_end:{value:"1",squash:!0},show_empty_lanes:{value:"0",squash:!0},per_shot:{value:"0",squash:!0}}}),t.state("competitions.admin.results.finals",{url:"/finals?patrol&patrol_type&station_start&station_end&lane_start&lane_end&show_empty_lanes&per_shot",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.results.filter_finals",controller:"CompetitionsAdminResultsRegistrationController as results"},"field@competitions.admin.results.finals":{templateUrl:"/views/partials.competitions.admin.results.field"},"military@competitions.admin.results.finals":{templateUrl:"/views/partials.competitions.admin.results.military"},"precision@competitions.admin.results.finals":{templateUrl:"/views/partials.competitions.admin.results.precision"}},params:{patrol:{value:"1",squash:!0},patrol_type:{value:"finals",squash:!0},station_start:{value:"1",squash:!0},station_end:{value:"3",squash:!0},lane_start:{value:"1",squash:!0},lane_end:{value:"10",squash:!0},show_empty_lanes:{value:"0",squash:!0},per_shot:{value:"0",squash:!0}}}),t.state("competitions.admin.results.distinguish",{url:"/distinguish?patrol&patrol_type&station_start&station_end&lane_start&lane_end&show_empty_lanes&per_shot",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.results.filter_distinguish",controller:"CompetitionsAdminResultsRegistrationController as results"},"field@competitions.admin.results.distinguish":{templateUrl:"/views/partials.competitions.admin.results.field"},"military@competitions.admin.results.distinguish":{templateUrl:"/views/partials.competitions.admin.results.military"},"precision@competitions.admin.results.distinguish":{templateUrl:"/views/partials.competitions.admin.results.precision"}},params:{patrol:{value:"1",squash:!0},patrol_type:{value:"distinguish",squash:!0},station_start:{value:"1",squash:!0},station_end:{value:"1",squash:!0},lane_start:{value:"1",squash:!0},lane_end:{value:"10",squash:!0},show_empty_lanes:{value:"0",squash:!0},per_shot:{value:"0",squash:!0}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("competitions.create",{parent:"root",url:"/competitions/create",restricted:!0,views:{"content@":{templateUrl:"/views/partials.competitions.create",controller:"CompetitionsCreateController",controllerAs:"competitions"}}}),t.state("competitions.admin",{"abstract":!0,parent:"root",url:"/competitions/:competitions_id/admin",restricted:!0,views:{"content@":{templateUrl:"/views/partials.competitions.admin",controller:"CompetitionsAdminController",controllerAs:"competitions"}}}),t.state("competitions.admin.index",{url:"",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.index"}}}),t.state("competitions.admin.close",{url:"/close",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.close"}}})}]),app.config(["$stateProvider",function(t){t.state("competitions.admin.teamsignups",{url:"/teamsignups","abstract":!0}),t.state("competitions.admin.teamsignups.index",{url:"",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.teamsignups.index",controller:"CompetitionsAdminTeamsController as signups"}}}),t.state("competitions.admin.teamsignups.create",{url:"/create",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.teamsignups.create",controller:"CompetitionsAdminTeamSignupsCreateController as signups"}}}),t.state("competitions.admin.teamsignups.edit",{url:"/:teams_id/edit",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.teamsignups.edit",controller:"CompetitionsAdminTeamSignupController as signups"}}})}]),app.config(["$stateProvider",function(t){t.state("competitions.admin.signups",{url:"/signups","abstract":!0}),t.state("competitions.admin.signups.index",{url:"?current_page&per_page&search&invoice&status",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.signups.index",controller:"CompetitionsAdminSignupsController as signups"}},params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},invoice:{value:"",squash:!0},status:{value:"",squash:!0}}}),t.state("competitions.admin.users",{url:"/users","abstract":!0}),t.state("competitions.admin.users.show",{url:"/:user_id",restricted:!0,views:{"main@competitions.admin":{templateUrl:"/views/partials.competitions.admin.users.index",controller:"CompetitionsAdminUsersController as user"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("competitions",{url:"/competitions?current_page&per_page&search&status&type&usersignup",parent:"root",views:{"content@":{templateUrl:"/views/partials.competitions.index",controller:"CompetitionsController",controllerAs:"competitions"}},params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},status:{value:"open",squash:!0},type:{value:"0",squash:!0},usersignup:{value:"",squash:!0}},restricted:!0}),t.state("competition",{url:"/competitions/:id",parent:"root",views:{"content@":{templateUrl:"/views/partials.competitions.show",controller:"CompetitionController",controllerAs:"competitions"}},restricted:!0}),t.state("competition.signups",{url:"/signups?current_page&per_page&search&status",restricted:!0,views:{main:{templateUrl:"/views/partials.competitions.show.signups",controller:"CompetitionsSignupsController as signups"}},params:{current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},status:{value:"",squash:!0}}}),t.state("competition.results",{url:"/results",views:{main:{templateUrl:"/views/partials.competitions.show.results",controller:"CompetitionsResultsController as results"}},restricted:!0,params:{signups_id:{value:"",squash:!0}}}),t.state("competition.patrols",{url:"/patrols",views:{main:{templateUrl:"/views/partials.competitions.show.patrols",controller:"CompetitionsPatrolsController as patrols"}},restricted:!0,params:{patrols_id:{value:"",squash:!0}}}),t.state("competition.teams",{url:"/teams",views:{main:{templateUrl:"/views/partials.competitions.show.teams",controller:"CompetitionsTeamsController as teams"}},restricted:!0,params:{teams_id:{value:"",squash:!0}}}),t.state("competition.clubsignups",{url:"/clubsignups",views:{main:{templateUrl:"/views/partials.competitions.show.clubsignups",controller:"ClubSignupController as clubsignups"}},restricted:!0}),t.state("competition.teamsignups",{url:"/teamsignups",views:{main:{templateUrl:"/views/partials.competitions.show.teamsignups.index",controller:"TeamSignupController as teamsignups"}},restricted:!0}),t.state("competition.teamsignups.create",{url:"/create",views:{"":{templateUrl:"/views/partials.competitions.show.teamsignups.create"}},restricted:!0}),t.state("competition.teamsignups.edit",{url:"/:teams_id",views:{"":{templateUrl:"/views/partials.competitions.show.teamsignups.edit",controller:"TeamSignupController as teamsignups"}},restricted:!0}),t.state("competition.signup",{url:"/signup",restricted:!0,views:{main:{templateUrl:"/views/partials.competitions.show.signup",controller:"CompetitionController as competitions"}}}),t.state("competition.show",{url:"/:view",views:{main:{templateUrl:function(t){return"/views/partials.competitions.show."+t.view},controller:["$rootScope","$stateParams",function(t,e){t.currentView=e.view}]}},restricted:!0})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("districts.show.invoices",{"abstract":!0,url:"/invoices",restricted:!0}),t.state("districts.show.invoices.index",{url:"",restricted:!0,views:{"main@districts.show":{templateUrl:"/views/partials.districts.invoices.index",controller:"DistrictInvoicesController as invoices"}}}),t.state("districts.show.invoices.incoming",{url:"/incoming?current_page&per_page&search&payment_status&direction",restricted:!0,views:{"main@districts.show":{templateUrl:"/views/partials.districts.invoices.incoming",controller:"DistrictInvoicesController as invoices"}},params:{direction:{value:"incoming",squash:!0},current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},payment_status:{value:"all",squash:!0},paid_at_start:{vaue:"",squash:!0},paid_at_end:{vaue:"",squash:!0},created_at_start:{vaue:"",squash:!0},created_at_end:{vaue:"",squash:!0}}}),t.state("districts.show.invoices.outgoing",{url:"/outgoing?current_page&per_page&search&payment_status&direction&orderby&paid_at_start&paid_at_end&created_at_start&created_at_end",restricted:!0,views:{"main@districts.show":{templateUrl:"/views/partials.districts.invoices.outgoing",controller:"DistrictInvoicesController as invoices"}},params:{direction:{value:"outgoing",squash:!0},current_page:{value:"1",squash:!0},per_page:{value:"10",squash:!0},search:{value:"",squash:!0},payment_status:{value:"all",squash:!0},orderby:{value:"created_at",squash:!0},paid_at_start:{value:"",squash:!0},paid_at_end:{value:"",squash:!0},created_at_start:{value:"",squash:!0},created_at_end:{value:"",squash:!0}}}),t.state("districts.show.invoices.show",{url:"/:id",restricted:!0,views:{"main@districts.show":{templateUrl:"/views/partials.districts.invoices.show",controller:"DistrictInvoiceController as invoices"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("districts",{url:"/districts",parent:"root","abstract":!0,restricted:!0}),t.state("districts.index",{url:"",restricted:!0,views:{"content@":{templateUrl:"/views/partials.districts.index",controller:"DistrictsController as districts"}}}),t.state("districts.show",{url:"/:districts_id",views:{"content@":{templateUrl:"/views/partials.districts.show",controller:"DistrictController as district"},"main@districts.show":{templateUrl:"/views/partials.districts.information"}},
restricted:!0}),t.state("districts.show.edit",{url:"/edit",views:{main:{templateUrl:"/views/partials.districts.edit"}},restricted:!0}),t.state("districts.show.admins",{url:"/admins",views:{main:{templateUrl:"/views/partials.districts.admins"}},restricted:!0})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("invoices",{parent:"root","abstract":!0,url:"/invoices",restricted:!0,views:{"content@":{templateUrl:"/views/partials.invoices.index"}}}),t.state("invoices.index",{url:"",restricted:!0,views:{"main@invoices":{templateUrl:"/views/partials.invoices.overview",controller:"InvoicesController as invoices"}}}),t.state("invoices.incoming",{url:"/incoming",restricted:!0,views:{"main@invoices":{templateUrl:"/views/partials.invoices.incoming",controller:"InvoicesController as invoices"}}}),t.state("invoices.outgoing",{url:"/outgoing",restricted:!0,views:{"main@invoices":{templateUrl:"/views/partials.invoices.outgoing",controller:"InvoicesController as invoices"}}}),t.state("invoices.generate",{url:"/generate",restricted:!0,views:{"main@invoices":{templateUrl:"/views/partials.invoices.generate",controller:"GenerateInvoicesController as invoices"}}}),t.state("invoices.show",{url:"/:id",restricted:!0,views:{"main@invoices":{templateUrl:"/views/partials.invoices.show",controller:"InvoiceController as invoices"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("premium",{url:"/premium",parent:"root",restricted:!0,views:{"content@":{templateUrl:"/views/partials.premium.index",controller:"PremiumController as premium"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("public.information",{url:"/",parent:"public",views:{"content@":{templateUrl:"/publicviews/information",controller:["$rootScope","$state",function(t,e){t.authenticated&&e.go("dashboard",{},{location:"replace"})}]}}}),t.state("public.competitions",{url:"/competitions",parent:"public",views:{"content@":{templateUrl:"/publicviews/competitions.index",controller:"PublicCompetitionsController",controllerAs:"competitions"}},params:{page:{value:"0",squash:!0},sort:{value:"date",squash:!0}}}),t.state("public.competitions.show",{url:"/:id",views:{"content@":{templateUrl:"/publicviews/competitions.show",controller:"PublicCompetitionsController as competitions"},"main@public.competitions.show":{templateUrl:"publicviews/competitions.show.information"}}}),t.state("public.competitions.show.signups",{url:"/signups",views:{"main@public.competitions.show":{templateUrl:"/publicviews/competitions.show.signups"}}}),t.state("public.competitions.show.results",{url:"/results",views:{"main@public.competitions.show":{templateUrl:"/publicviews/competitions.show.results"}}}),t.state("public.competitions.show.patrols",{url:"/patrols",views:{"main@public.competitions.show":{templateUrl:"/publicviews/competitions.show.patrols"}}}),t.state("public.competitions.show.teams",{url:"/teams",views:{"main@public.competitions.show":{templateUrl:"/publicviews/competitions.show.teams"}}})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){e.html5Mode(!0);var n=localStorage.getItem("user");n?a.otherwise("/app/"):a.otherwise("/"),t.state("root",{"abstract":!0,url:"/app",views:{"navigation@":{templateUrl:"/views/partials.navigation"}}}),t.state("public",{"abstract":!0,views:{"navigation@":{templateUrl:"/publicviews/navigation"}}}),t.state("dashboard",{url:"/",parent:"root",views:{"content@":{templateUrl:"/views/partials.dashboard",controller:"DashboardController"}},restricted:!0})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("settings",{url:"/settings",parent:"root","abstract":!0,restricted:!0,views:{"content@":{templateUrl:"/views/partials.settings.index",controller:"SettingsController",controllerAs:"settings"}}}),t.state("settings.index",{url:"/",views:{setting:{controller:["$state",function(t){t.go("settings.user")}]}},restricted:!0}),t.state("settings.user",{url:"/user",views:{setting:{templateUrl:"/views/partials.settings.user",controller:"UserProfileController as userprofile"}},restricted:!0}),t.state("settings.editprofile",{url:"/editprofile",views:{setting:{templateUrl:"/views/partials.settings.useredit",controller:"UserProfileController as userprofile"}},restricted:!0}),t.state("settings.cancelaccount",{url:"/cancelaccount",views:{setting:{templateUrl:"/views/partials.settings.cancelaccount"}},restricted:!0}),t.state("settings.password",{url:"/password",views:{setting:{templateUrl:"/views/partials.settings.password",controller:"PasswordController as password"}},restricted:!0}),t.state("settings.invite",{url:"/invite",views:{setting:{templateUrl:"/views/partials.settings.invite",controller:"InviteController as invite"}},restricted:!0})}]),app.config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,a){t.state("signups",{url:"/signups",parent:"root",views:{"content@":{templateUrl:"/views/partials.signups.index",controller:"SignupsController",controllerAs:"signups"}},restricted:!0}),t.state("signup",{url:"/signup/:id",parent:"root",views:{"content@":{templateUrl:"/views/partials.signups.show",controller:"SignupController",controllerAs:"signups"}},restricted:!0}),t.state("signup.edit",{url:"/edit",views:{"content@":{templateUrl:"/views/partials.signups.edit",controller:"SignupController",controllerAs:"signups"}},restricted:!0})}]);